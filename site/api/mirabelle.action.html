<!DOCTYPE html PUBLIC ""
    "">
<html><head><meta charset="UTF-8" /><title>mirabelle.action documentation</title><link rel="stylesheet" type="text/css" href="css/default.css" /><link rel="stylesheet" type="text/css" href="css/highlight.css" /><script type="text/javascript" src="js/highlight.min.js"></script><script type="text/javascript" src="js/jquery.min.js"></script><script type="text/javascript" src="js/page_effects.js"></script><script>hljs.initHighlightingOnLoad();</script></head><body><div id="header"><h2>Generated by <a href="https://github.com/weavejester/codox">Codox</a></h2><h1><a href="index.html"><span class="project-title"><span class="project-name">Mirabelle</span> <span class="project-version">0.1.0-SNAPSHOT</span></span></a></h1></div><div class="sidebar primary"><h3 class="no-link"><span class="inner">Project</span></h3><ul class="index-link"><li class="depth-1 "><a href="index.html"><div class="inner">Index</div></a></li></ul><h3 class="no-link"><span class="inner">Namespaces</span></h3><ul><li class="depth-1"><div class="no-link"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>mirabelle</span></div></div></li><li class="depth-2 current"><a href="mirabelle.action.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>action</span></div></a></li><li class="depth-3"><a href="mirabelle.action.condition.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>condition</span></div></a></li><li class="depth-2 branch"><a href="mirabelle.b64.html"><div class="inner"><span class="tree" style="top: -52px;"><span class="top" style="height: 61px;"></span><span class="bottom"></span></span><span>b64</span></div></a></li><li class="depth-2 branch"><a href="mirabelle.config.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>config</span></div></a></li><li class="depth-2 branch"><a href="mirabelle.core.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>core</span></div></a></li><li class="depth-2"><div class="no-link"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>db</span></div></div></li><li class="depth-3"><a href="mirabelle.db.queue.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>queue</span></div></a></li><li class="depth-2 branch"><a href="mirabelle.event.html"><div class="inner"><span class="tree" style="top: -52px;"><span class="top" style="height: 61px;"></span><span class="bottom"></span></span><span>event</span></div></a></li><li class="depth-2 branch"><a href="mirabelle.handler.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>handler</span></div></a></li><li class="depth-2 branch"><a href="mirabelle.http.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>http</span></div></a></li><li class="depth-2 branch"><a href="mirabelle.index.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>index</span></div></a></li><li class="depth-2"><div class="no-link"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>interceptor</span></div></div></li><li class="depth-3"><a href="mirabelle.interceptor.route.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>route</span></div></a></li><li class="depth-2"><a href="mirabelle.io.html"><div class="inner"><span class="tree" style="top: -52px;"><span class="top" style="height: 61px;"></span><span class="bottom"></span></span><span>io</span></div></a></li><li class="depth-3 branch"><a href="mirabelle.io.file.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>file</span></div></a></li><li class="depth-3 branch"><a href="mirabelle.io.influxdb.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>influxdb</span></div></a></li><li class="depth-3"><a href="mirabelle.io.pagerduty.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>pagerduty</span></div></a></li><li class="depth-2 branch"><a href="mirabelle.math.html"><div class="inner"><span class="tree" style="top: -114px;"><span class="top" style="height: 123px;"></span><span class="bottom"></span></span><span>math</span></div></a></li><li class="depth-2 branch"><a href="mirabelle.path.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>path</span></div></a></li><li class="depth-2 branch"><a href="mirabelle.pool.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>pool</span></div></a></li><li class="depth-2 branch"><a href="mirabelle.pubsub.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>pubsub</span></div></a></li><li class="depth-2 branch"><a href="mirabelle.spec.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>spec</span></div></a></li><li class="depth-2 branch"><a href="mirabelle.stream.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>stream</span></div></a></li><li class="depth-2 branch"><a href="mirabelle.test.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>test</span></div></a></li><li class="depth-2 branch"><a href="mirabelle.time.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>time</span></div></a></li><li class="depth-2"><a href="mirabelle.transport.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>transport</span></div></a></li><li class="depth-3 branch"><a href="mirabelle.transport.tcp.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>tcp</span></div></a></li><li class="depth-3"><a href="mirabelle.transport.websocket.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>websocket</span></div></a></li><li class="depth-1"><a href="user.html"><div class="inner"><span class="tree" style="top: -889px;"><span class="top" style="height: 898px;"></span><span class="bottom"></span></span><span>user</span></div></a></li></ul></div><div class="sidebar secondary"><h3><a href="#top"><span class="inner">Public Vars</span></a></h3><ul><li class="depth-1"><a href="mirabelle.action.html#var-above-dt"><div class="inner"><span>above-dt</span></div></a></li><li class="depth-1"><a href="mirabelle.action.html#var-action-.3Efn"><div class="inner"><span>action-&gt;fn</span></div></a></li><li class="depth-1"><a href="mirabelle.action.html#var-async-queue.21"><div class="inner"><span>async-queue!</span></div></a></li><li class="depth-1"><a href="mirabelle.action.html#var-async-queue.21*"><div class="inner"><span>async-queue!*</span></div></a></li><li class="depth-1"><a href="mirabelle.action.html#var-below-dt"><div class="inner"><span>below-dt</span></div></a></li><li class="depth-1"><a href="mirabelle.action.html#var-between-dt"><div class="inner"><span>between-dt</span></div></a></li><li class="depth-1"><a href="mirabelle.action.html#var-by"><div class="inner"><span>by</span></div></a></li><li class="depth-1"><a href="mirabelle.action.html#var-by-fn"><div class="inner"><span>by-fn</span></div></a></li><li class="depth-1"><a href="mirabelle.action.html#var-call-rescue"><div class="inner"><span>call-rescue</span></div></a></li><li class="depth-1"><a href="mirabelle.action.html#var-changed"><div class="inner"><span>changed</span></div></a></li><li class="depth-1"><a href="mirabelle.action.html#var-changed*"><div class="inner"><span>changed*</span></div></a></li><li class="depth-1"><a href="mirabelle.action.html#var-coalesce"><div class="inner"><span>coalesce</span></div></a></li><li class="depth-1"><a href="mirabelle.action.html#var-coalesce*"><div class="inner"><span>coalesce*</span></div></a></li><li class="depth-1"><a href="mirabelle.action.html#var-coll-count"><div class="inner"><span>coll-count</span></div></a></li><li class="depth-1"><a href="mirabelle.action.html#var-coll-count*"><div class="inner"><span>coll-count*</span></div></a></li><li class="depth-1"><a href="mirabelle.action.html#var-coll-max"><div class="inner"><span>coll-max</span></div></a></li><li class="depth-1"><a href="mirabelle.action.html#var-coll-max*"><div class="inner"><span>coll-max*</span></div></a></li><li class="depth-1"><a href="mirabelle.action.html#var-coll-mean"><div class="inner"><span>coll-mean</span></div></a></li><li class="depth-1"><a href="mirabelle.action.html#var-coll-mean*"><div class="inner"><span>coll-mean*</span></div></a></li><li class="depth-1"><a href="mirabelle.action.html#var-coll-min"><div class="inner"><span>coll-min</span></div></a></li><li class="depth-1"><a href="mirabelle.action.html#var-coll-min*"><div class="inner"><span>coll-min*</span></div></a></li><li class="depth-1"><a href="mirabelle.action.html#var-coll-quotient"><div class="inner"><span>coll-quotient</span></div></a></li><li class="depth-1"><a href="mirabelle.action.html#var-coll-quotient*"><div class="inner"><span>coll-quotient*</span></div></a></li><li class="depth-1"><a href="mirabelle.action.html#var-coll-rate"><div class="inner"><span>coll-rate</span></div></a></li><li class="depth-1"><a href="mirabelle.action.html#var-coll-rate*"><div class="inner"><span>coll-rate*</span></div></a></li><li class="depth-1"><a href="mirabelle.action.html#var-coll-sum"><div class="inner"><span>coll-sum</span></div></a></li><li class="depth-1"><a href="mirabelle.action.html#var-coll-sum*"><div class="inner"><span>coll-sum*</span></div></a></li><li class="depth-1"><a href="mirabelle.action.html#var-cond-dt*"><div class="inner"><span>cond-dt*</span></div></a></li><li class="depth-1"><a href="mirabelle.action.html#var-critical"><div class="inner"><span>critical</span></div></a></li><li class="depth-1"><a href="mirabelle.action.html#var-critical*"><div class="inner"><span>critical*</span></div></a></li><li class="depth-1"><a href="mirabelle.action.html#var-critical-dt"><div class="inner"><span>critical-dt</span></div></a></li><li class="depth-1"><a href="mirabelle.action.html#var-custom"><div class="inner"><span>custom</span></div></a></li><li class="depth-1"><a href="mirabelle.action.html#var-ddt"><div class="inner"><span>ddt</span></div></a></li><li class="depth-1"><a href="mirabelle.action.html#var-ddt*"><div class="inner"><span>ddt*</span></div></a></li><li class="depth-1"><a href="mirabelle.action.html#var-ddt-pos"><div class="inner"><span>ddt-pos</span></div></a></li><li class="depth-1"><a href="mirabelle.action.html#var-debug"><div class="inner"><span>debug</span></div></a></li><li class="depth-1"><a href="mirabelle.action.html#var-debug*"><div class="inner"><span>debug*</span></div></a></li><li class="depth-1"><a href="mirabelle.action.html#var-decrement"><div class="inner"><span>decrement</span></div></a></li><li class="depth-1"><a href="mirabelle.action.html#var-decrement*"><div class="inner"><span>decrement*</span></div></a></li><li class="depth-1"><a href="mirabelle.action.html#var-default"><div class="inner"><span>default</span></div></a></li><li class="depth-1"><a href="mirabelle.action.html#var-default*"><div class="inner"><span>default*</span></div></a></li><li class="depth-1"><a href="mirabelle.action.html#var-discard-fn"><div class="inner"><span>discard-fn</span></div></a></li><li class="depth-1"><a href="mirabelle.action.html#var-disk-queue.21"><div class="inner"><span>disk-queue!</span></div></a></li><li class="depth-1"><a href="mirabelle.action.html#var-disk-queue.21*"><div class="inner"><span>disk-queue!*</span></div></a></li><li class="depth-1"><a href="mirabelle.action.html#var-error"><div class="inner"><span>error</span></div></a></li><li class="depth-1"><a href="mirabelle.action.html#var-error*"><div class="inner"><span>error*</span></div></a></li><li class="depth-1"><a href="mirabelle.action.html#var-ewma-timeless"><div class="inner"><span>ewma-timeless</span></div></a></li><li class="depth-1"><a href="mirabelle.action.html#var-ewma-timeless*"><div class="inner"><span>ewma-timeless*</span></div></a></li><li class="depth-1"><a href="mirabelle.action.html#var-exception-.3Eevent"><div class="inner"><span>exception-&gt;event</span></div></a></li><li class="depth-1"><a href="mirabelle.action.html#var-exception-stream"><div class="inner"><span>exception-stream</span></div></a></li><li class="depth-1"><a href="mirabelle.action.html#var-exception-stream*"><div class="inner"><span>exception-stream*</span></div></a></li><li class="depth-1"><a href="mirabelle.action.html#var-expired"><div class="inner"><span>expired</span></div></a></li><li class="depth-1"><a href="mirabelle.action.html#var-expired*"><div class="inner"><span>expired*</span></div></a></li><li class="depth-1"><a href="mirabelle.action.html#var-fixed-event-window"><div class="inner"><span>fixed-event-window</span></div></a></li><li class="depth-1"><a href="mirabelle.action.html#var-fixed-event-window*"><div class="inner"><span>fixed-event-window*</span></div></a></li><li class="depth-1"><a href="mirabelle.action.html#var-fixed-time-window"><div class="inner"><span>fixed-time-window</span></div></a></li><li class="depth-1"><a href="mirabelle.action.html#var-fixed-time-window*"><div class="inner"><span>fixed-time-window*</span></div></a></li><li class="depth-1"><a href="mirabelle.action.html#var-from-base64"><div class="inner"><span>from-base64</span></div></a></li><li class="depth-1"><a href="mirabelle.action.html#var-from-base64*"><div class="inner"><span>from-base64*</span></div></a></li><li class="depth-1"><a href="mirabelle.action.html#var-increment"><div class="inner"><span>increment</span></div></a></li><li class="depth-1"><a href="mirabelle.action.html#var-increment*"><div class="inner"><span>increment*</span></div></a></li><li class="depth-1"><a href="mirabelle.action.html#var-index"><div class="inner"><span>index</span></div></a></li><li class="depth-1"><a href="mirabelle.action.html#var-index*"><div class="inner"><span>index*</span></div></a></li><li class="depth-1"><a href="mirabelle.action.html#var-info"><div class="inner"><span>info</span></div></a></li><li class="depth-1"><a href="mirabelle.action.html#var-info*"><div class="inner"><span>info*</span></div></a></li><li class="depth-1"><a href="mirabelle.action.html#var-io"><div class="inner"><span>io</span></div></a></li><li class="depth-1"><a href="mirabelle.action.html#var-io*"><div class="inner"><span>io*</span></div></a></li><li class="depth-1"><a href="mirabelle.action.html#var-json-fields"><div class="inner"><span>json-fields</span></div></a></li><li class="depth-1"><a href="mirabelle.action.html#var-json-fields*"><div class="inner"><span>json-fields*</span></div></a></li><li class="depth-1"><a href="mirabelle.action.html#var-keep-non-discarded-events"><div class="inner"><span>keep-non-discarded-events</span></div></a></li><li class="depth-1"><a href="mirabelle.action.html#var-log-action"><div class="inner"><span>log-action</span></div></a></li><li class="depth-1"><a href="mirabelle.action.html#var-moving-event-window"><div class="inner"><span>moving-event-window</span></div></a></li><li class="depth-1"><a href="mirabelle.action.html#var-moving-event-window*"><div class="inner"><span>moving-event-window*</span></div></a></li><li class="depth-1"><a href="mirabelle.action.html#var-not-expired"><div class="inner"><span>not-expired</span></div></a></li><li class="depth-1"><a href="mirabelle.action.html#var-not-expired*"><div class="inner"><span>not-expired*</span></div></a></li><li class="depth-1"><a href="mirabelle.action.html#var-outside-dt"><div class="inner"><span>outside-dt</span></div></a></li><li class="depth-1"><a href="mirabelle.action.html#var-over"><div class="inner"><span>over</span></div></a></li><li class="depth-1"><a href="mirabelle.action.html#var-over*"><div class="inner"><span>over*</span></div></a></li><li class="depth-1"><a href="mirabelle.action.html#var-percentiles"><div class="inner"><span>percentiles</span></div></a></li><li class="depth-1"><a href="mirabelle.action.html#var-percentiles*"><div class="inner"><span>percentiles*</span></div></a></li><li class="depth-1"><a href="mirabelle.action.html#var-project"><div class="inner"><span>project</span></div></a></li><li class="depth-1"><a href="mirabelle.action.html#var-project*"><div class="inner"><span>project*</span></div></a></li><li class="depth-1"><a href="mirabelle.action.html#var-publish.21"><div class="inner"><span>publish!</span></div></a></li><li class="depth-1"><a href="mirabelle.action.html#var-publish.21*"><div class="inner"><span>publish!*</span></div></a></li><li class="depth-1"><a href="mirabelle.action.html#var-push-io.21"><div class="inner"><span>push-io!</span></div></a></li><li class="depth-1"><a href="mirabelle.action.html#var-push-io.21*"><div class="inner"><span>push-io!*</span></div></a></li><li class="depth-1"><a href="mirabelle.action.html#var-reaper"><div class="inner"><span>reaper</span></div></a></li><li class="depth-1"><a href="mirabelle.action.html#var-reaper*"><div class="inner"><span>reaper*</span></div></a></li><li class="depth-1"><a href="mirabelle.action.html#var-reinject.21"><div class="inner"><span>reinject!</span></div></a></li><li class="depth-1"><a href="mirabelle.action.html#var-reinject.21*"><div class="inner"><span>reinject!*</span></div></a></li><li class="depth-1"><a href="mirabelle.action.html#var-scale"><div class="inner"><span>scale</span></div></a></li><li class="depth-1"><a href="mirabelle.action.html#var-scale*"><div class="inner"><span>scale*</span></div></a></li><li class="depth-1"><a href="mirabelle.action.html#var-sdissoc"><div class="inner"><span>sdissoc</span></div></a></li><li class="depth-1"><a href="mirabelle.action.html#var-sdissoc*"><div class="inner"><span>sdissoc*</span></div></a></li><li class="depth-1"><a href="mirabelle.action.html#var-sdo"><div class="inner"><span>sdo</span></div></a></li><li class="depth-1"><a href="mirabelle.action.html#var-sdo*"><div class="inner"><span>sdo*</span></div></a></li><li class="depth-1"><a href="mirabelle.action.html#var-sflatten"><div class="inner"><span>sflatten</span></div></a></li><li class="depth-1"><a href="mirabelle.action.html#var-sflatten*"><div class="inner"><span>sflatten*</span></div></a></li><li class="depth-1"><a href="mirabelle.action.html#var-sformat"><div class="inner"><span>sformat</span></div></a></li><li class="depth-1"><a href="mirabelle.action.html#var-sformat*"><div class="inner"><span>sformat*</span></div></a></li><li class="depth-1"><a href="mirabelle.action.html#var-split"><div class="inner"><span>split</span></div></a></li><li class="depth-1"><a href="mirabelle.action.html#var-split*"><div class="inner"><span>split*</span></div></a></li><li class="depth-1"><a href="mirabelle.action.html#var-stream"><div class="inner"><span>stream</span></div></a></li><li class="depth-1"><a href="mirabelle.action.html#var-streams"><div class="inner"><span>streams</span></div></a></li><li class="depth-1"><a href="mirabelle.action.html#var-tag"><div class="inner"><span>tag</span></div></a></li><li class="depth-1"><a href="mirabelle.action.html#var-tag*"><div class="inner"><span>tag*</span></div></a></li><li class="depth-1"><a href="mirabelle.action.html#var-tagged-all"><div class="inner"><span>tagged-all</span></div></a></li><li class="depth-1"><a href="mirabelle.action.html#var-tagged-all*"><div class="inner"><span>tagged-all*</span></div></a></li><li class="depth-1"><a href="mirabelle.action.html#var-tap"><div class="inner"><span>tap</span></div></a></li><li class="depth-1"><a href="mirabelle.action.html#var-tap*"><div class="inner"><span>tap*</span></div></a></li><li class="depth-1"><a href="mirabelle.action.html#var-test-action"><div class="inner"><span>test-action</span></div></a></li><li class="depth-1"><a href="mirabelle.action.html#var-test-action*"><div class="inner"><span>test-action*</span></div></a></li><li class="depth-1"><a href="mirabelle.action.html#var-throttle"><div class="inner"><span>throttle</span></div></a></li><li class="depth-1"><a href="mirabelle.action.html#var-throttle*"><div class="inner"><span>throttle*</span></div></a></li><li class="depth-1"><a href="mirabelle.action.html#var-to-base64"><div class="inner"><span>to-base64</span></div></a></li><li class="depth-1"><a href="mirabelle.action.html#var-to-base64*"><div class="inner"><span>to-base64*</span></div></a></li><li class="depth-1"><a href="mirabelle.action.html#var-under"><div class="inner"><span>under</span></div></a></li><li class="depth-1"><a href="mirabelle.action.html#var-under*"><div class="inner"><span>under*</span></div></a></li><li class="depth-1"><a href="mirabelle.action.html#var-untag"><div class="inner"><span>untag</span></div></a></li><li class="depth-1"><a href="mirabelle.action.html#var-untag*"><div class="inner"><span>untag*</span></div></a></li><li class="depth-1"><a href="mirabelle.action.html#var-warning"><div class="inner"><span>warning</span></div></a></li><li class="depth-1"><a href="mirabelle.action.html#var-warning*"><div class="inner"><span>warning*</span></div></a></li><li class="depth-1"><a href="mirabelle.action.html#var-where"><div class="inner"><span>where</span></div></a></li><li class="depth-1"><a href="mirabelle.action.html#var-where*"><div class="inner"><span>where*</span></div></a></li><li class="depth-1"><a href="mirabelle.action.html#var-with"><div class="inner"><span>with</span></div></a></li><li class="depth-1"><a href="mirabelle.action.html#var-with*"><div class="inner"><span>with*</span></div></a></li></ul></div><div class="namespace-docs" id="content"><h1 class="anchor" id="top">mirabelle.action</h1><div class="doc"><div class="markdown"></div></div><div class="public anchor" id="var-above-dt"><h3>above-dt</h3><div class="usage"><code>(above-dt threshold dt &amp; children)</code></div><div class="doc"><div class="markdown"><p>Takes a number <code>threshold</code> and a time period in seconds <code>dt</code>. If the condition “the event metric is &gt; to the threshold” is valid for all events received during at least the period <code>dt</code>, valid events received after the <code>dt</code> period will be passed on until an invalid event arrives. <code>:metric</code> should not be nil (it will produce exceptions).</p>
<pre><code class="clojure">(above-dt 100 10
  (debug))
</code></pre>
<p>In this example, if the events <code>:metric</code> field are greater than 100 for more than 10 seconds, events are passed downstream.</p></div></div><div class="src-link"><a href="https://github.com/mcorbin/mirabelle/blob/0.1.0-SNAPSHOT/src/clojure/mirabelle/action.clj#L410">view source</a></div></div><div class="public anchor" id="var-action-.3Efn"><h3>action-&gt;fn</h3><div class="usage"></div><div class="doc"><div class="markdown"></div></div><div class="src-link"><a href="https://github.com/mcorbin/mirabelle/blob/0.1.0-SNAPSHOT/src/clojure/mirabelle/action.clj#L1853">view source</a></div></div><div class="public anchor" id="var-async-queue.21"><h3>async-queue!</h3><div class="usage"><code>(async-queue! queue-name &amp; children)</code></div><div class="doc"><div class="markdown"><p>Execute children into the specific async queue. The async queue should be defined in the I/O configuration file.</p>
<pre><code class="clojure">(async-queue! :my-queue
  (info))
</code></pre></div></div><div class="src-link"><a href="https://github.com/mcorbin/mirabelle/blob/0.1.0-SNAPSHOT/src/clojure/mirabelle/action.clj#L1549">view source</a></div></div><div class="public anchor" id="var-async-queue.21*"><h3>async-queue!*</h3><div class="usage"><code>(async-queue!* context queue-name &amp; children)</code></div><div class="doc"><div class="markdown"></div></div><div class="src-link"><a href="https://github.com/mcorbin/mirabelle/blob/0.1.0-SNAPSHOT/src/clojure/mirabelle/action.clj#L1537">view source</a></div></div><div class="public anchor" id="var-below-dt"><h3>below-dt</h3><div class="usage"><code>(below-dt threshold dt &amp; children)</code></div><div class="doc"><div class="markdown"><p>Takes a number <code>threshold</code> and a time period in seconds <code>dt</code>. If the condition <code>the event metric is &lt; to the threshold</code> is valid for all events received during at least the period <code>dt</code>, valid events received after the <code>dt</code> period will be passed on until an invalid event arrives. <code>:metric</code> should not be nil (it will produce exceptions).</p>
<p><code>clojure
(below-dt 100 10
  (debug))
</code></p>
<p>In this example, if the events <code>:metric</code> field are lower than 100 for more than 10 seconds, events are passed downstream.</p></div></div><div class="src-link"><a href="https://github.com/mcorbin/mirabelle/blob/0.1.0-SNAPSHOT/src/clojure/mirabelle/action.clj#L432">view source</a></div></div><div class="public anchor" id="var-between-dt"><h3>between-dt</h3><div class="usage"><code>(between-dt low high dt &amp; children)</code></div><div class="doc"><div class="markdown"><p>Takes two numbers, <code>low</code> and <code>high</code>, and a time period in seconds, <code>dt</code>. If the condition <code>the event metric is &gt; low and &lt; high</code> is valid for all events received during at least the period <code>dt</code>, valid events received after the <code>dt</code> period will be passed on until an invalid event arrives. <code>:metric</code> should not be nil (it will produce exceptions).</p>
<pre><code class="clojure">(between-dt 50 100 10
  (debug))
</code></pre>
<p>In this example, if the events <code>:metric</code> field are between 50 ans 100 for more than 10 seconds, events are passed downstream.</p></div></div><div class="src-link"><a href="https://github.com/mcorbin/mirabelle/blob/0.1.0-SNAPSHOT/src/clojure/mirabelle/action.clj#L454">view source</a></div></div><div class="public anchor" id="var-by"><h3>by</h3><div class="usage"><code>(by fields &amp; children)</code></div><div class="doc"><div class="markdown"><p>Split stream by field Every time an event arrives with a new value of field, this action invokes its child forms to return a <em>new</em>, distinct set of streams for that particular value.</p>
<pre><code class="clojure">(by [:host :service]
  (moving-time-window 5))
</code></pre>
<p>This example generates a moving window for each host/service combination.</p></div></div><div class="src-link"><a href="https://github.com/mcorbin/mirabelle/blob/0.1.0-SNAPSHOT/src/clojure/mirabelle/action.clj#L1471">view source</a></div></div><div class="public anchor" id="var-by-fn"><h3>by-fn</h3><div class="usage"><code>(by-fn fields new-fork)</code></div><div class="doc"><div class="markdown"></div></div><div class="src-link"><a href="https://github.com/mcorbin/mirabelle/blob/0.1.0-SNAPSHOT/src/clojure/mirabelle/action.clj#L1455">view source</a></div></div><div class="public anchor" id="var-call-rescue"><h3>call-rescue</h3><div class="usage"><code>(call-rescue event children)</code></div><div class="doc"><div class="markdown"></div></div><div class="src-link"><a href="https://github.com/mcorbin/mirabelle/blob/0.1.0-SNAPSHOT/src/clojure/mirabelle/action.clj#L18">view source</a></div></div><div class="public anchor" id="var-changed"><h3>changed</h3><div class="usage"><code>(changed field init &amp; children)</code></div><div class="doc"><div class="markdown"><p>Passes on events only if the <code>field</code> passed as parameter differs from the previous one. The <code>init</code> parameter is the default value for the stream.</p>
<pre><code class="clojure">(changed :state "ok")
</code></pre>
<p>For example, this action will let event pass if the :state field vary, the initial value being <code>ok</code>.</p>
<p>This stream is useful to get only events making a transition.</p></div></div><div class="src-link"><a href="https://github.com/mcorbin/mirabelle/blob/0.1.0-SNAPSHOT/src/clojure/mirabelle/action.clj#L1247">view source</a></div></div><div class="public anchor" id="var-changed*"><h3>changed*</h3><div class="usage"><code>(changed* _ field init &amp; children)</code></div><div class="doc"><div class="markdown"></div></div><div class="src-link"><a href="https://github.com/mcorbin/mirabelle/blob/0.1.0-SNAPSHOT/src/clojure/mirabelle/action.clj#L1231">view source</a></div></div><div class="public anchor" id="var-coalesce"><h3>coalesce</h3><div class="usage"><code>(coalesce dt fields &amp; children)</code></div><div class="doc"><div class="markdown"><p>Returns a list of the latest non-expired events (by <code>fields</code>) every dt seconds (at best).</p>
<pre><code class="clojure">(coalesce 10 [:host :service]
  (debug)
</code></pre>
<p>In this example, the latest event for each host/service combination will be kept and forwarded downstream. The <code>debug</code> action will then receive this list of events. Expired events will be removed from the list.</p></div></div><div class="src-link"><a href="https://github.com/mcorbin/mirabelle/blob/0.1.0-SNAPSHOT/src/clojure/mirabelle/action.clj#L691">view source</a></div></div><div class="public anchor" id="var-coalesce*"><h3>coalesce*</h3><div class="usage"><code>(coalesce* _ dt fields &amp; children)</code></div><div class="doc"><div class="markdown"></div></div><div class="src-link"><a href="https://github.com/mcorbin/mirabelle/blob/0.1.0-SNAPSHOT/src/clojure/mirabelle/action.clj#L620">view source</a></div></div><div class="public anchor" id="var-coll-count"><h3>coll-count</h3><div class="usage"><code>(coll-count &amp; children)</code></div><div class="doc"><div class="markdown"><p>Count the number of events. Should receive a list of events from the previous stream. The most recent event is used as a base to create the new event, and its :metric field is set to the number of events received as input.</p>
<pre><code class="clojure">(fixed-time-window 60
  (coll-count
    (debug)))
</code></pre></div></div><div class="src-link"><a href="https://github.com/mcorbin/mirabelle/blob/0.1.0-SNAPSHOT/src/clojure/mirabelle/action.clj#L1388">view source</a></div></div><div class="public anchor" id="var-coll-count*"><h3>coll-count*</h3><div class="usage"><code>(coll-count* _ &amp; children)</code></div><div class="doc"><div class="markdown"></div></div><div class="src-link"><a href="https://github.com/mcorbin/mirabelle/blob/0.1.0-SNAPSHOT/src/clojure/mirabelle/action.clj#L1380">view source</a></div></div><div class="public anchor" id="var-coll-max"><h3>coll-max</h3><div class="usage"><code>(coll-max &amp; children)</code></div><div class="doc"><div class="markdown"><p>Returns the event with the biggest metric. Should receive a list of events from the previous stream.</p>
<pre><code class="clojure">(fixed-event-window 10
  (coll-max
    (debug)))
</code></pre>
<p>Get the event the biggest metric on windows of 10 events</p></div></div><div class="src-link"><a href="https://github.com/mcorbin/mirabelle/blob/0.1.0-SNAPSHOT/src/clojure/mirabelle/action.clj#L218">view source</a></div></div><div class="public anchor" id="var-coll-max*"><h3>coll-max*</h3><div class="usage"><code>(coll-max* _ &amp; children)</code></div><div class="doc"><div class="markdown"></div></div><div class="src-link"><a href="https://github.com/mcorbin/mirabelle/blob/0.1.0-SNAPSHOT/src/clojure/mirabelle/action.clj#L213">view source</a></div></div><div class="public anchor" id="var-coll-mean"><h3>coll-mean</h3><div class="usage"><code>(coll-mean &amp; children)</code></div><div class="doc"><div class="markdown"><p>Computes the events mean (on metric). Should receive a list of events from the previous stream. The most recent event is used as a base to create the new event</p>
<pre><code class="clojure">(fixed-event-window 10
  (coll-mean
    (debug)))
</code></pre>
<p>Computes the mean on windows of 10 events</p></div></div><div class="src-link"><a href="https://github.com/mcorbin/mirabelle/blob/0.1.0-SNAPSHOT/src/clojure/mirabelle/action.clj#L197">view source</a></div></div><div class="public anchor" id="var-coll-mean*"><h3>coll-mean*</h3><div class="usage"><code>(coll-mean* _ &amp; children)</code></div><div class="doc"><div class="markdown"></div></div><div class="src-link"><a href="https://github.com/mcorbin/mirabelle/blob/0.1.0-SNAPSHOT/src/clojure/mirabelle/action.clj#L192">view source</a></div></div><div class="public anchor" id="var-coll-min"><h3>coll-min</h3><div class="usage"><code>(coll-min &amp; children)</code></div><div class="doc"><div class="markdown"><p>Returns the event with the smallest metric. Should receive a list of events from the previous stream.</p>
<pre><code class="clojure">(fixed-event-window 10
  (coll-min
    (debug)))
</code></pre>
<p>Get the event the smallest metric on windows of 10 events</p></div></div><div class="src-link"><a href="https://github.com/mcorbin/mirabelle/blob/0.1.0-SNAPSHOT/src/clojure/mirabelle/action.clj#L272">view source</a></div></div><div class="public anchor" id="var-coll-min*"><h3>coll-min*</h3><div class="usage"><code>(coll-min* _ &amp; children)</code></div><div class="doc"><div class="markdown"></div></div><div class="src-link"><a href="https://github.com/mcorbin/mirabelle/blob/0.1.0-SNAPSHOT/src/clojure/mirabelle/action.clj#L267">view source</a></div></div><div class="public anchor" id="var-coll-quotient"><h3>coll-quotient</h3><div class="usage"><code>(coll-quotient &amp; children)</code></div><div class="doc"><div class="markdown"><p>Divide the first event <code>:metrìc</code> field by all subsequent events <code>:metric</code>. Return a new event containing the new <code>:metric</code>.</p>
<p>Should receive a list of events from the previous stream.</p></div></div><div class="src-link"><a href="https://github.com/mcorbin/mirabelle/blob/0.1.0-SNAPSHOT/src/clojure/mirabelle/action.clj#L238">view source</a></div></div><div class="public anchor" id="var-coll-quotient*"><h3>coll-quotient*</h3><div class="usage"><code>(coll-quotient* _ &amp; children)</code></div><div class="doc"><div class="markdown"></div></div><div class="src-link"><a href="https://github.com/mcorbin/mirabelle/blob/0.1.0-SNAPSHOT/src/clojure/mirabelle/action.clj#L233">view source</a></div></div><div class="public anchor" id="var-coll-rate"><h3>coll-rate</h3><div class="usage"><code>(coll-rate &amp; children)</code></div><div class="doc"><div class="markdown"><p>Computes the rate on a list of events. Should receive a list of events from the previous stream. The latest event is used as a base to build the new event.</p>
<pre><code class="clojure">(fixed-event-window 3
  (coll-rate
    (debug)))
</code></pre>
<p>If this example receives the events:</p>
<p>{:metric 1 :time 1} {:metric 2 :time 2} {:metric 1 :time 3}</p>
<p>The stream will return {:metric 2 :time 3}</p>
<p>Indeed, (1+2+1)/2 = 3 (we divide by 2 because we have 2 seconds between the min and max events time).</p></div></div><div class="src-link"><a href="https://github.com/mcorbin/mirabelle/blob/0.1.0-SNAPSHOT/src/clojure/mirabelle/action.clj#L756">view source</a></div></div><div class="public anchor" id="var-coll-rate*"><h3>coll-rate*</h3><div class="usage"><code>(coll-rate* _ &amp; children)</code></div><div class="doc"><div class="markdown"></div></div><div class="src-link"><a href="https://github.com/mcorbin/mirabelle/blob/0.1.0-SNAPSHOT/src/clojure/mirabelle/action.clj#L751">view source</a></div></div><div class="public anchor" id="var-coll-sum"><h3>coll-sum</h3><div class="usage"><code>(coll-sum &amp; children)</code></div><div class="doc"><div class="markdown"><p>Sum all the events :metric fields Should receive a list of events from the previous stream.</p>
<pre><code class="clojure">(fixed-event-window 10
  (coll-sum
    (debug)))
</code></pre>
<p>Sum all :metric fields for windows of 10 events</p></div></div><div class="src-link"><a href="https://github.com/mcorbin/mirabelle/blob/0.1.0-SNAPSHOT/src/clojure/mirabelle/action.clj#L252">view source</a></div></div><div class="public anchor" id="var-coll-sum*"><h3>coll-sum*</h3><div class="usage"><code>(coll-sum* _ &amp; children)</code></div><div class="doc"><div class="markdown"></div></div><div class="src-link"><a href="https://github.com/mcorbin/mirabelle/blob/0.1.0-SNAPSHOT/src/clojure/mirabelle/action.clj#L247">view source</a></div></div><div class="public anchor" id="var-cond-dt*"><h3>cond-dt*</h3><div class="usage"><code>(cond-dt* _ conditions dt &amp; children)</code></div><div class="doc"><div class="markdown"><p>A stream which detects if a condition <code>(f event)</code> is true during <code>dt</code> seconds. Takes <code>conditions</code> (like in the where action) and a time period <code>dt</code> in seconds. If the condition is valid for all events received during at least the period <code>dt</code>, valid events received after the <code>dt</code> period will be passed on until an invalid event arrives. Skips events that are too old or that do not have a timestamp.</p></div></div><div class="src-link"><a href="https://github.com/mcorbin/mirabelle/blob/0.1.0-SNAPSHOT/src/clojure/mirabelle/action.clj#L369">view source</a></div></div><div class="public anchor" id="var-critical"><h3>critical</h3><div class="usage"><code>(critical &amp; children)</code></div><div class="doc"><div class="markdown"><p>Keep all events in state critical.</p>
<pre><code class="clojure">(critical
  (error))
</code></pre>
<p>In this example, all events with <code>:state</code> “critical” will be logged.</p></div></div><div class="src-link"><a href="https://github.com/mcorbin/mirabelle/blob/0.1.0-SNAPSHOT/src/clojure/mirabelle/action.clj#L531">view source</a></div></div><div class="public anchor" id="var-critical*"><h3>critical*</h3><div class="usage"><code>(critical* _ &amp; children)</code></div><div class="doc"><div class="markdown"></div></div><div class="src-link"><a href="https://github.com/mcorbin/mirabelle/blob/0.1.0-SNAPSHOT/src/clojure/mirabelle/action.clj#L525">view source</a></div></div><div class="public anchor" id="var-critical-dt"><h3>critical-dt</h3><div class="usage"><code>(critical-dt dt &amp; children)</code></div><div class="doc"><div class="markdown"><p>Takes a time period in seconds <code>dt</code>. If all events received during at least the period <code>dt</code> have <code>:state</code> critical, new critical events received after the <code>dt</code> period will be passed on until an invalid event arrives.</p>
<pre><code class="clojure">(critical-dt 10
  (debug))
</code></pre>
<p>In this example, if the events <code>:state</code> are “critical” for more than 10 seconds, events are passed downstream.</p></div></div><div class="src-link"><a href="https://github.com/mcorbin/mirabelle/blob/0.1.0-SNAPSHOT/src/clojure/mirabelle/action.clj#L505">view source</a></div></div><div class="public anchor" id="var-custom"><h3>custom</h3><div class="usage"><code>(custom action-name params &amp; children)</code></div><div class="doc"><div class="markdown"><p>Executes a custom action. Custom actions are defined in the Mirabelle configuration file. The actomn can then be called (by name) using this <code>custom</code> action.</p>
<pre><code class="clojure">(custom :my-custom-action ["parameters"]
  (info))
</code></pre></div></div><div class="src-link"><a href="https://github.com/mcorbin/mirabelle/blob/0.1.0-SNAPSHOT/src/clojure/mirabelle/action.clj#L1701">view source</a></div></div><div class="public anchor" id="var-ddt"><h3>ddt</h3><div class="usage"><code>(ddt &amp; children)</code></div><div class="doc"><div class="markdown"><p>Differentiate metrics with respect to time. Takes an optional number followed by child streams. Emits an event for each event received, but with metric equal to the difference between the current event and the previous one, divided by the difference in their times. Skips events without metrics.</p>
<pre><code class="clojure">(ddt
  (info))
</code></pre>
<p>If ddt receives {:metric 1 :time 1} and {:metric 10 :time 4}, it will produce {:metric (/ 9 3) :time 4}.</p></div></div><div class="src-link"><a href="https://github.com/mcorbin/mirabelle/blob/0.1.0-SNAPSHOT/src/clojure/mirabelle/action.clj#L918">view source</a></div></div><div class="public anchor" id="var-ddt*"><h3>ddt*</h3><div class="usage"><code>(ddt* _ remove-neg? &amp; children)</code></div><div class="doc"><div class="markdown"></div></div><div class="src-link"><a href="https://github.com/mcorbin/mirabelle/blob/0.1.0-SNAPSHOT/src/clojure/mirabelle/action.clj#L903">view source</a></div></div><div class="public anchor" id="var-ddt-pos"><h3>ddt-pos</h3><div class="usage"><code>(ddt-pos &amp; children)</code></div><div class="doc"><div class="markdown"><p>Like ddt but do not forward events with negative metrics. This can be used for counters which may be reseted to zero for example.</p></div></div><div class="src-link"><a href="https://github.com/mcorbin/mirabelle/blob/0.1.0-SNAPSHOT/src/clojure/mirabelle/action.clj#L937">view source</a></div></div><div class="public anchor" id="var-debug"><h3>debug</h3><div class="usage"><code>(debug)</code></div><div class="doc"><div class="markdown"><p>Print the event in the logs using the debug level</p>
<pre><code class="clojure">(increment
  (debug))
</code></pre></div></div><div class="src-link"><a href="https://github.com/mcorbin/mirabelle/blob/0.1.0-SNAPSHOT/src/clojure/mirabelle/action.clj#L124">view source</a></div></div><div class="public anchor" id="var-debug*"><h3>debug*</h3><div class="usage"><code>(debug* _)</code></div><div class="doc"><div class="markdown"></div></div><div class="src-link"><a href="https://github.com/mcorbin/mirabelle/blob/0.1.0-SNAPSHOT/src/clojure/mirabelle/action.clj#L120">view source</a></div></div><div class="public anchor" id="var-decrement"><h3>decrement</h3><div class="usage"><code>(decrement &amp; children)</code></div><div class="doc"><div class="markdown"><p>Decrement the event :metric field.</p>
<pre><code>(decrement
  (index [:host]))
</code></pre></div></div><div class="src-link"><a href="https://github.com/mcorbin/mirabelle/blob/0.1.0-SNAPSHOT/src/clojure/mirabelle/action.clj#L98">view source</a></div></div><div class="public anchor" id="var-decrement*"><h3>decrement*</h3><div class="usage"><code>(decrement* _ &amp; children)</code></div><div class="doc"><div class="markdown"></div></div><div class="src-link"><a href="https://github.com/mcorbin/mirabelle/blob/0.1.0-SNAPSHOT/src/clojure/mirabelle/action.clj#L92">view source</a></div></div><div class="public anchor" id="var-default"><h3>default</h3><div class="usage"><code>(default field value &amp; children)</code></div><div class="doc"><div class="markdown"><p>Set a default value for an event</p>
<pre><code class="clojure">(default :state "ok"
  (info))
</code></pre>
<p>In this example, all events where <code>:state</code> is not set will be updated with <code>:state</code> to “ok”.</p></div></div><div class="src-link"><a href="https://github.com/mcorbin/mirabelle/blob/0.1.0-SNAPSHOT/src/clojure/mirabelle/action.clj#L574">view source</a></div></div><div class="public anchor" id="var-default*"><h3>default*</h3><div class="usage"><code>(default* _ field value &amp; children)</code></div><div class="doc"><div class="markdown"></div></div><div class="src-link"><a href="https://github.com/mcorbin/mirabelle/blob/0.1.0-SNAPSHOT/src/clojure/mirabelle/action.clj#L565">view source</a></div></div><div class="public anchor" id="var-discard-fn"><h3>discard-fn</h3><div class="usage"><code>(discard-fn e)</code></div><div class="doc"><div class="markdown"></div></div><div class="src-link"><a href="https://github.com/mcorbin/mirabelle/blob/0.1.0-SNAPSHOT/src/clojure/mirabelle/action.clj#L23">view source</a></div></div><div class="public anchor" id="var-disk-queue.21"><h3>disk-queue!</h3><div class="usage"><code>(disk-queue!)</code></div><div class="doc"><div class="markdown"><p>Write events into the on-disk queue.</p></div></div><div class="src-link"><a href="https://github.com/mcorbin/mirabelle/blob/0.1.0-SNAPSHOT/src/clojure/mirabelle/action.clj#L1498">view source</a></div></div><div class="public anchor" id="var-disk-queue.21*"><h3>disk-queue!*</h3><div class="usage"><code>(disk-queue!* context)</code></div><div class="doc"><div class="markdown"></div></div><div class="src-link"><a href="https://github.com/mcorbin/mirabelle/blob/0.1.0-SNAPSHOT/src/clojure/mirabelle/action.clj#L1489">view source</a></div></div><div class="public anchor" id="var-error"><h3>error</h3><div class="usage"><code>(error)</code></div><div class="doc"><div class="markdown"><p>Print the event in the logs using the error level</p>
<pre><code class="clojure">(increment
  (debug))
</code></pre></div></div><div class="src-link"><a href="https://github.com/mcorbin/mirabelle/blob/0.1.0-SNAPSHOT/src/clojure/mirabelle/action.clj#L152">view source</a></div></div><div class="public anchor" id="var-error*"><h3>error*</h3><div class="usage"><code>(error* _)</code></div><div class="doc"><div class="markdown"></div></div><div class="src-link"><a href="https://github.com/mcorbin/mirabelle/blob/0.1.0-SNAPSHOT/src/clojure/mirabelle/action.clj#L148">view source</a></div></div><div class="public anchor" id="var-ewma-timeless"><h3>ewma-timeless</h3><div class="usage"><code>(ewma-timeless r &amp; children)</code></div><div class="doc"><div class="markdown"><p>Exponential weighted moving average. Constant space and time overhead. Passes on each event received, but with metric adjusted to the moving average. Does not take the time between events into account. R is the ratio between successive events: r=1 means always return the most recent metric; r=1/2 means the current event counts for half, the previous event for 1/4, the previous event for 1/8, and so on.</p></div></div><div class="src-link"><a href="https://github.com/mcorbin/mirabelle/blob/0.1.0-SNAPSHOT/src/clojure/mirabelle/action.clj#L1169">view source</a></div></div><div class="public anchor" id="var-ewma-timeless*"><h3>ewma-timeless*</h3><div class="usage"><code>(ewma-timeless* _ r &amp; children)</code></div><div class="doc"><div class="markdown"></div></div><div class="src-link"><a href="https://github.com/mcorbin/mirabelle/blob/0.1.0-SNAPSHOT/src/clojure/mirabelle/action.clj#L1154">view source</a></div></div><div class="public anchor" id="var-exception-.3Eevent"><h3>exception-&gt;event</h3><div class="usage"><code>(exception-&gt;event e base-event)</code></div><div class="doc"><div class="markdown"><p>Build a new event from an Exception and from the event which caused it.</p></div></div><div class="src-link"><a href="https://github.com/mcorbin/mirabelle/blob/0.1.0-SNAPSHOT/src/clojure/mirabelle/action.clj#L1639">view source</a></div></div><div class="public anchor" id="var-exception-stream"><h3>exception-stream</h3><div class="usage"><code>(exception-stream &amp; children)</code></div><div class="doc"><div class="markdown"><p>Takes two actions. If an exception is thrown in the first action, an event representing this exception is emitted in in the second action.</p>
<pre><code>(exception-stream
  (bad-action)
  (error))
</code></pre>
<p>Here, if <code>bad-action</code> throws, an event will be built (using the <code>exception-&gt;event</code> function) and sent to the <code>error</code> action (which will log it).</p></div></div><div class="src-link"><a href="https://github.com/mcorbin/mirabelle/blob/0.1.0-SNAPSHOT/src/clojure/mirabelle/action.clj#L1659">view source</a></div></div><div class="public anchor" id="var-exception-stream*"><h3>exception-stream*</h3><div class="usage"><code>(exception-stream* _ success-child failure-child)</code></div><div class="doc"><div class="markdown"></div></div><div class="src-link"><a href="https://github.com/mcorbin/mirabelle/blob/0.1.0-SNAPSHOT/src/clojure/mirabelle/action.clj#L1651">view source</a></div></div><div class="public anchor" id="var-expired"><h3>expired</h3><div class="usage"><code>(expired &amp; children)</code></div><div class="doc"><div class="markdown"><p>Keep expired events.</p>
<pre><code class="clojure">(expired
  (increment))
</code></pre>
<p>In this example, all expired events will be forwarded to the <code>increment</code>stream.</p></div></div><div class="src-link"><a href="https://github.com/mcorbin/mirabelle/blob/0.1.0-SNAPSHOT/src/clojure/mirabelle/action.clj#L332">view source</a></div></div><div class="public anchor" id="var-expired*"><h3>expired*</h3><div class="usage"><code>(expired* _ &amp; children)</code></div><div class="doc"><div class="markdown"><p>Keep expired events.</p></div></div><div class="src-link"><a href="https://github.com/mcorbin/mirabelle/blob/0.1.0-SNAPSHOT/src/clojure/mirabelle/action.clj#L322">view source</a></div></div><div class="public anchor" id="var-fixed-event-window"><h3>fixed-event-window</h3><div class="usage"><code>(fixed-event-window size &amp; children)</code></div><div class="doc"><div class="markdown"><p>Returns a fixed-sized window of events.</p>
<pre><code class="clojure">(fixed-event-window 5
  (debug))
</code></pre>
<p>This example will return a vector events partitioned 5 by 5.</p></div></div><div class="src-link"><a href="https://github.com/mcorbin/mirabelle/blob/0.1.0-SNAPSHOT/src/clojure/mirabelle/action.clj#L177">view source</a></div></div><div class="public anchor" id="var-fixed-event-window*"><h3>fixed-event-window*</h3><div class="usage"><code>(fixed-event-window* _ size &amp; children)</code></div><div class="doc"><div class="markdown"></div></div><div class="src-link"><a href="https://github.com/mcorbin/mirabelle/blob/0.1.0-SNAPSHOT/src/clojure/mirabelle/action.clj#L163">view source</a></div></div><div class="public anchor" id="var-fixed-time-window"><h3>fixed-time-window</h3><div class="usage"><code>(fixed-time-window n &amp; children)</code></div><div class="doc"><div class="markdown"><p>A fixed window over the event stream in time. Emits vectors of events, such that each vector has events from a distinct n-second interval. Windows do <em>not</em> overlap; each event appears at most once in the output stream. Once an event is emitted, all events <em>older or equal</em> to that emitted event are silently dropped.</p>
<p>Events without times accrue in the current window.</p>
<pre><code class="clojure">(fixed-time-window 60
  (coll-max
    (info)))
</code></pre></div></div><div class="src-link"><a href="https://github.com/mcorbin/mirabelle/blob/0.1.0-SNAPSHOT/src/clojure/mirabelle/action.clj#L1105">view source</a></div></div><div class="public anchor" id="var-fixed-time-window*"><h3>fixed-time-window*</h3><div class="usage"><code>(fixed-time-window* _ n &amp; children)</code></div><div class="doc"><div class="markdown"></div></div><div class="src-link"><a href="https://github.com/mcorbin/mirabelle/blob/0.1.0-SNAPSHOT/src/clojure/mirabelle/action.clj#L1057">view source</a></div></div><div class="public anchor" id="var-from-base64"><h3>from-base64</h3><div class="usage"><code>(from-base64 field &amp; children)</code></div><div class="doc"><div class="markdown"><p>Convert a field or multiple fields from base64 to string. Fields values should be string.</p>
<pre><code class="clojure">(sdo
  ;; you can pass one field
  (from-base64 :host)
  ;; or a list of fields
  (from-base64 [:host :service]))
</code></pre></div></div><div class="src-link"><a href="https://github.com/mcorbin/mirabelle/blob/0.1.0-SNAPSHOT/src/clojure/mirabelle/action.clj#L1776">view source</a></div></div><div class="public anchor" id="var-from-base64*"><h3>from-base64*</h3><div class="usage"><code>(from-base64* _ fields &amp; children)</code></div><div class="doc"><div class="markdown"></div></div><div class="src-link"><a href="https://github.com/mcorbin/mirabelle/blob/0.1.0-SNAPSHOT/src/clojure/mirabelle/action.clj#L1769">view source</a></div></div><div class="public anchor" id="var-increment"><h3>increment</h3><div class="usage"><code>(increment &amp; children)</code></div><div class="doc"><div class="markdown"><p>Increment the event :metric field.</p>
<pre><code>(increment
  (index [:host]))
</code></pre></div></div><div class="src-link"><a href="https://github.com/mcorbin/mirabelle/blob/0.1.0-SNAPSHOT/src/clojure/mirabelle/action.clj#L80">view source</a></div></div><div class="public anchor" id="var-increment*"><h3>increment*</h3><div class="usage"><code>(increment* _ &amp; children)</code></div><div class="doc"><div class="markdown"></div></div><div class="src-link"><a href="https://github.com/mcorbin/mirabelle/blob/0.1.0-SNAPSHOT/src/clojure/mirabelle/action.clj#L74">view source</a></div></div><div class="public anchor" id="var-index"><h3>index</h3><div class="usage"><code>(index labels)</code></div><div class="doc"><div class="markdown"><p>Insert events into the index. Events are indexed using the keys passed as parameter.</p>
<pre><code class="clojure">(index [:host :service])
</code></pre>
<p>This example will index events by host and services.</p></div></div><div class="src-link"><a href="https://github.com/mcorbin/mirabelle/blob/0.1.0-SNAPSHOT/src/clojure/mirabelle/action.clj#L1366">view source</a></div></div><div class="public anchor" id="var-index*"><h3>index*</h3><div class="usage"><code>(index* context labels)</code></div><div class="doc"><div class="markdown"></div></div><div class="src-link"><a href="https://github.com/mcorbin/mirabelle/blob/0.1.0-SNAPSHOT/src/clojure/mirabelle/action.clj#L1352">view source</a></div></div><div class="public anchor" id="var-info"><h3>info</h3><div class="usage"><code>(info)</code></div><div class="doc"><div class="markdown"><p>Print the event in the logs using the info level</p>
<pre><code class="clojure">(increment
  (info))
</code></pre></div></div><div class="src-link"><a href="https://github.com/mcorbin/mirabelle/blob/0.1.0-SNAPSHOT/src/clojure/mirabelle/action.clj#L138">view source</a></div></div><div class="public anchor" id="var-info*"><h3>info*</h3><div class="usage"><code>(info* _)</code></div><div class="doc"><div class="markdown"></div></div><div class="src-link"><a href="https://github.com/mcorbin/mirabelle/blob/0.1.0-SNAPSHOT/src/clojure/mirabelle/action.clj#L134">view source</a></div></div><div class="public anchor" id="var-io"><h3>io</h3><div class="usage"><code>(io &amp; children)</code></div><div class="doc"><div class="markdown"><p>Discard all events in test mode. Else, forward to children. You can use this stream to avoid side effects in test mode.</p></div></div><div class="src-link"><a href="https://github.com/mcorbin/mirabelle/blob/0.1.0-SNAPSHOT/src/clojure/mirabelle/action.clj#L1569">view source</a></div></div><div class="public anchor" id="var-io*"><h3>io*</h3><div class="usage"><code>(io* context &amp; children)</code></div><div class="doc"><div class="markdown"></div></div><div class="src-link"><a href="https://github.com/mcorbin/mirabelle/blob/0.1.0-SNAPSHOT/src/clojure/mirabelle/action.clj#L1563">view source</a></div></div><div class="public anchor" id="var-json-fields"><h3>json-fields</h3><div class="usage"><code>(json-fields fields &amp; children)</code></div><div class="doc"><div class="markdown"><p>Takes a field or a list of fields, and converts the values associated to these fields from json to edn.</p>
<pre><code class="clojure">(with :my-field "{"foo": "bar"}
  (json-fields [:my-field]))
</code></pre>
<p>In this example, we associate to <code>:my-field</code> a json string and then we call <code>json-fields</code> on it. <code>:my-field</code> will now contain an edn map built from the json data, with keywords as keys.</p></div></div><div class="src-link"><a href="https://github.com/mcorbin/mirabelle/blob/0.1.0-SNAPSHOT/src/clojure/mirabelle/action.clj#L1620">view source</a></div></div><div class="public anchor" id="var-json-fields*"><h3>json-fields*</h3><div class="usage"><code>(json-fields* _ fields &amp; children)</code></div><div class="doc"><div class="markdown"></div></div><div class="src-link"><a href="https://github.com/mcorbin/mirabelle/blob/0.1.0-SNAPSHOT/src/clojure/mirabelle/action.clj#L1604">view source</a></div></div><div class="public anchor" id="var-keep-non-discarded-events"><h3>keep-non-discarded-events</h3><div class="usage"><code>(keep-non-discarded-events events)</code></div><div class="doc"><div class="markdown"><p>Takes an event or a list of events. Returns an event (or a list of events depending of the input) with all events tagged “discard” filtered. Returns nil if all events are filtered.</p></div></div><div class="src-link"><a href="https://github.com/mcorbin/mirabelle/blob/0.1.0-SNAPSHOT/src/clojure/mirabelle/action.clj#L27">view source</a></div></div><div class="public anchor" id="var-log-action"><h3>log-action</h3><div class="usage"><code>(log-action level)</code></div><div class="doc"><div class="markdown"><p>Generic logger</p></div></div><div class="src-link"><a href="https://github.com/mcorbin/mirabelle/blob/0.1.0-SNAPSHOT/src/clojure/mirabelle/action.clj#L110">view source</a></div></div><div class="public anchor" id="var-moving-event-window"><h3>moving-event-window</h3><div class="usage"><code>(moving-event-window n &amp; children)</code></div><div class="doc"><div class="markdown"><p>A sliding window of the last few events. Every time an event arrives, calls children with a vector of the last n events, from oldest to newest. Ignores event times. Example:</p>
<pre><code class="clojure">(moving-event-window 5
  (coll-mean (info))
</code></pre></div></div><div class="src-link"><a href="https://github.com/mcorbin/mirabelle/blob/0.1.0-SNAPSHOT/src/clojure/mirabelle/action.clj#L1138">view source</a></div></div><div class="public anchor" id="var-moving-event-window*"><h3>moving-event-window*</h3><div class="usage"><code>(moving-event-window* _ n &amp; children)</code></div><div class="doc"><div class="markdown"></div></div><div class="src-link"><a href="https://github.com/mcorbin/mirabelle/blob/0.1.0-SNAPSHOT/src/clojure/mirabelle/action.clj#L1127">view source</a></div></div><div class="public anchor" id="var-not-expired"><h3>not-expired</h3><div class="usage"><code>(not-expired &amp; children)</code></div><div class="doc"><div class="markdown"><p>Keep non-expired events.</p>
<pre><code class="clojure">(not-expired
  (increment))

In this example, all non-expired events will be forwarded to the `increment`stream.
</code></pre></div></div><div class="src-link"><a href="https://github.com/mcorbin/mirabelle/blob/0.1.0-SNAPSHOT/src/clojure/mirabelle/action.clj#L356">view source</a></div></div><div class="public anchor" id="var-not-expired*"><h3>not-expired*</h3><div class="usage"><code>(not-expired* _ &amp; children)</code></div><div class="doc"><div class="markdown"><p>Keep non-expired events.</p></div></div><div class="src-link"><a href="https://github.com/mcorbin/mirabelle/blob/0.1.0-SNAPSHOT/src/clojure/mirabelle/action.clj#L346">view source</a></div></div><div class="public anchor" id="var-outside-dt"><h3>outside-dt</h3><div class="usage"><code>(outside-dt low high dt &amp; children)</code></div><div class="doc"><div class="markdown"><p>Takes two numbers, <code>low</code> and <code>high</code>, and a time period in seconds, <code>dt</code>. If the condition <code>the event metric is &lt; low or &gt; high</code> is valid for all events received during at least the period <code>dt</code>, valid events received after the <code>dt</code> period will be passed on until an invalid event arrives. <code>:metric</code> should not be nil (it will produce exceptions).</p>
<pre><code class="clojure">(outside-dt 50 100 10
  (debug))
</code></pre>
<p>In this example, if the events <code>:metric</code> field are outside the 50-100 range for more than 10 seconds, events are passed downstream.</p></div></div><div class="src-link"><a href="https://github.com/mcorbin/mirabelle/blob/0.1.0-SNAPSHOT/src/clojure/mirabelle/action.clj#L479">view source</a></div></div><div class="public anchor" id="var-over"><h3>over</h3><div class="usage"><code>(over n &amp; children)</code></div><div class="doc"><div class="markdown"><p>Passes on events only when their metric is greater than x.</p>
<pre><code class="clojure">(over 10
  (info))
</code></pre></div></div><div class="src-link"><a href="https://github.com/mcorbin/mirabelle/blob/0.1.0-SNAPSHOT/src/clojure/mirabelle/action.clj#L1193">view source</a></div></div><div class="public anchor" id="var-over*"><h3>over*</h3><div class="usage"><code>(over* _ n &amp; children)</code></div><div class="doc"><div class="markdown"></div></div><div class="src-link"><a href="https://github.com/mcorbin/mirabelle/blob/0.1.0-SNAPSHOT/src/clojure/mirabelle/action.clj#L1183">view source</a></div></div><div class="public anchor" id="var-percentiles"><h3>percentiles</h3><div class="usage"><code>(percentiles points &amp; children)</code></div><div class="doc"><div class="markdown"><p>Over each period of interval seconds, aggregates events and selects one event from that period for each point. If point is 0, takes the lowest metric event. If point is 1, takes the highest metric event. 0.5 is the median event, and so forth. Forwards each of these events to children. The event has the point appended the <code>:quantile</code> key. Useful for extracting histograms and percentiles.</p>
<pre><code class="clojure">(fixed-event-window 10
  (percentiles [0.5 0.75 0.98 0.99]))
</code></pre></div></div><div class="src-link"><a href="https://github.com/mcorbin/mirabelle/blob/0.1.0-SNAPSHOT/src/clojure/mirabelle/action.clj#L1436">view source</a></div></div><div class="public anchor" id="var-percentiles*"><h3>percentiles*</h3><div class="usage"><code>(percentiles* _ points &amp; children)</code></div><div class="doc"><div class="markdown"></div></div><div class="src-link"><a href="https://github.com/mcorbin/mirabelle/blob/0.1.0-SNAPSHOT/src/clojure/mirabelle/action.clj#L1426">view source</a></div></div><div class="public anchor" id="var-project"><h3>project</h3><div class="usage"><code>(project conditions &amp; children)</code></div><div class="doc"><div class="markdown"><p>Takes a list of conditions. Like coalesce, project will return the most recent events matching the conditions.</p>
<pre><code class="clojure">(project [[:= :service "enqueues"]
          [:= :service "dequeues"]]
  (coll-quotient
    (with :service "enqueues per dequeue"
      (info))))
</code></pre>
<p>We divide here the latest event for the “enqueues” :service by the latest event from the “dequeues” one.</p></div></div><div class="src-link"><a href="https://github.com/mcorbin/mirabelle/blob/0.1.0-SNAPSHOT/src/clojure/mirabelle/action.clj#L1330">view source</a></div></div><div class="public anchor" id="var-project*"><h3>project*</h3><div class="usage"><code>(project* _ conditions &amp; children)</code></div><div class="doc"><div class="markdown"></div></div><div class="src-link"><a href="https://github.com/mcorbin/mirabelle/blob/0.1.0-SNAPSHOT/src/clojure/mirabelle/action.clj#L1266">view source</a></div></div><div class="public anchor" id="var-publish.21"><h3>publish!</h3><div class="usage"><code>(publish! channel)</code></div><div class="doc"><div class="markdown"><p>Publish events in the given channel.</p>
<pre><code class="clojure">(publish! :my-channel)
</code></pre>
<p>Users can then subscribe to channels using the websocket engine.</p></div></div><div class="src-link"><a href="https://github.com/mcorbin/mirabelle/blob/0.1.0-SNAPSHOT/src/clojure/mirabelle/action.clj#L1839">view source</a></div></div><div class="public anchor" id="var-publish.21*"><h3>publish!*</h3><div class="usage"><code>(publish!* context channel)</code></div><div class="doc"><div class="markdown"></div></div><div class="src-link"><a href="https://github.com/mcorbin/mirabelle/blob/0.1.0-SNAPSHOT/src/clojure/mirabelle/action.clj#L1829">view source</a></div></div><div class="public anchor" id="var-push-io.21"><h3>push-io!</h3><div class="usage"><code>(push-io! io-name)</code></div><div class="doc"><div class="markdown"><p>Push events to an external system.</p>
<p>I/O are defined in a dedicated file. If you create a new I/O named <code>:influxdb</code> for example, you can use push-io! to push all events into this I/O:</p>
<pre><code class="clojure">(push-io! :influxdb)
</code></pre>
<p>I/O are automatically discarded in test mode.</p></div></div><div class="src-link"><a href="https://github.com/mcorbin/mirabelle/blob/0.1.0-SNAPSHOT/src/clojure/mirabelle/action.clj#L604">view source</a></div></div><div class="public anchor" id="var-push-io.21*"><h3>push-io!*</h3><div class="usage"><code>(push-io!* context io-name)</code></div><div class="doc"><div class="markdown"></div></div><div class="src-link"><a href="https://github.com/mcorbin/mirabelle/blob/0.1.0-SNAPSHOT/src/clojure/mirabelle/action.clj#L590">view source</a></div></div><div class="public anchor" id="var-reaper"><h3>reaper</h3><div class="usage"><code>(reaper)</code><code>(reaper destination-stream)</code></div><div class="doc"><div class="markdown"><p>Everytime this action receives an event, it will expires events from the index and reinject them into a stream (default to the default streams).</p>
<pre><code class="clojure">(reaper)
</code></pre>
<pre><code class="clojure">(reaper :custom-stream
</code></pre></div></div><div class="src-link"><a href="https://github.com/mcorbin/mirabelle/blob/0.1.0-SNAPSHOT/src/clojure/mirabelle/action.clj#L1725">view source</a></div></div><div class="public anchor" id="var-reaper*"><h3>reaper*</h3><div class="usage"><code>(reaper* context destination-stream)</code></div><div class="doc"><div class="markdown"></div></div><div class="src-link"><a href="https://github.com/mcorbin/mirabelle/blob/0.1.0-SNAPSHOT/src/clojure/mirabelle/action.clj#L1715">view source</a></div></div><div class="public anchor" id="var-reinject.21"><h3>reinject!</h3><div class="usage"><code>(reinject!)</code><code>(reinject! destination-stream)</code></div><div class="doc"><div class="markdown"><p>Reinject an event into the streaming system. By default, events are reinject into the real time engine. You can reinject events to a specific stream by passing the destination stream as parameter.</p>
<pre><code class="clojure">(reinject)
</code></pre>
<p>This example reinjects events into the real stream engine.</p>
<pre><code class="clojure">(reinject :foo)
</code></pre>
<p>This example reinjects events into the stream named <code>:foo</code>.</p></div></div><div class="src-link"><a href="https://github.com/mcorbin/mirabelle/blob/0.1.0-SNAPSHOT/src/clojure/mirabelle/action.clj#L1512">view source</a></div></div><div class="public anchor" id="var-reinject.21*"><h3>reinject!*</h3><div class="usage"><code>(reinject!* context destination-stream)</code></div><div class="doc"><div class="markdown"></div></div><div class="src-link"><a href="https://github.com/mcorbin/mirabelle/blob/0.1.0-SNAPSHOT/src/clojure/mirabelle/action.clj#L1504">view source</a></div></div><div class="public anchor" id="var-scale"><h3>scale</h3><div class="usage"><code>(scale factor &amp; children)</code></div><div class="doc"><div class="markdown"><p>Multiplies the event :metric field by the factor passed as parameter.</p>
<pre><code class="clojure">(scale 1000
  (info
</code></pre>
<p>This example will multiply the :metric field for all events by 1000.</p></div></div><div class="src-link"><a href="https://github.com/mcorbin/mirabelle/blob/0.1.0-SNAPSHOT/src/clojure/mirabelle/action.clj#L952">view source</a></div></div><div class="public anchor" id="var-scale*"><h3>scale*</h3><div class="usage"><code>(scale* _ factor &amp; children)</code></div><div class="doc"><div class="markdown"></div></div><div class="src-link"><a href="https://github.com/mcorbin/mirabelle/blob/0.1.0-SNAPSHOT/src/clojure/mirabelle/action.clj#L945">view source</a></div></div><div class="public anchor" id="var-sdissoc"><h3>sdissoc</h3><div class="usage"><code>(sdissoc fields &amp; children)</code></div><div class="doc"><div class="markdown"><p>Remove a key (or a list of keys) from the events/</p>
<pre><code class="clojure">(sdissoc :host (info))

(sdissoc [:environment :host] (info))
</code></pre></div></div><div class="src-link"><a href="https://github.com/mcorbin/mirabelle/blob/0.1.0-SNAPSHOT/src/clojure/mirabelle/action.clj#L1412">view source</a></div></div><div class="public anchor" id="var-sdissoc*"><h3>sdissoc*</h3><div class="usage"><code>(sdissoc* _ fields &amp; children)</code></div><div class="doc"><div class="markdown"></div></div><div class="src-link"><a href="https://github.com/mcorbin/mirabelle/blob/0.1.0-SNAPSHOT/src/clojure/mirabelle/action.clj#L1406">view source</a></div></div><div class="public anchor" id="var-sdo"><h3>sdo</h3><div class="usage"><code>(sdo &amp; children)</code></div><div class="doc"><div class="markdown"><p>Send events to children. useful when you want to send the same events to multiple downstream actions.</p>
<pre><code class="clojure">(sdo
  (increment)
  (decrement))
</code></pre>
<p>Here, events arriving in sdo will be forwarded to both increment and decrement.</p></div></div><div class="src-link"><a href="https://github.com/mcorbin/mirabelle/blob/0.1.0-SNAPSHOT/src/clojure/mirabelle/action.clj#L305">view source</a></div></div><div class="public anchor" id="var-sdo*"><h3>sdo*</h3><div class="usage"><code>(sdo* _ &amp; children)</code></div><div class="doc"><div class="markdown"></div></div><div class="src-link"><a href="https://github.com/mcorbin/mirabelle/blob/0.1.0-SNAPSHOT/src/clojure/mirabelle/action.clj#L300">view source</a></div></div><div class="public anchor" id="var-sflatten"><h3>sflatten</h3><div class="usage"><code>(sflatten &amp; children)</code></div><div class="doc"><div class="markdown"><p>Streaming flatten. Calls children with each event in events. Events should be a sequence.</p>
<p>This stream can be used to “flat” a sequence of events (emitted by a time window stream for example).</p>
<pre><code class="clojure">(fixed-event-window 5
  (sflatten
    (info)))
</code></pre></div></div><div class="src-link"><a href="https://github.com/mcorbin/mirabelle/blob/0.1.0-SNAPSHOT/src/clojure/mirabelle/action.clj#L786">view source</a></div></div><div class="public anchor" id="var-sflatten*"><h3>sflatten*</h3><div class="usage"><code>(sflatten* _ &amp; children)</code></div><div class="doc"><div class="markdown"></div></div><div class="src-link"><a href="https://github.com/mcorbin/mirabelle/blob/0.1.0-SNAPSHOT/src/clojure/mirabelle/action.clj#L780">view source</a></div></div><div class="public anchor" id="var-sformat"><h3>sformat</h3><div class="usage"><code>(sformat template target-field fields &amp; children)</code></div><div class="doc"><div class="markdown"><p>Takes the content of multiple event keys, and use them to build a string value and assign it to a given key.</p>
<pre><code class="clojure">(sformat "%s-foo-%s" :format-test [:host :service])
</code></pre>
<p>If the event <code>{:host "machine" :service "bar"}</code> is passed to this action the event will become <code>{:host "machine" :service "bar" :format-test "machine-foo-bar"}</code>.</p>
<p>More information about availables formatters in the Clojure documentation: <a href="https://clojuredocs.org/clojure.core/format">https://clojuredocs.org/clojure.core/format</a></p></div></div><div class="src-link"><a href="https://github.com/mcorbin/mirabelle/blob/0.1.0-SNAPSHOT/src/clojure/mirabelle/action.clj#L1809">view source</a></div></div><div class="public anchor" id="var-sformat*"><h3>sformat*</h3><div class="usage"><code>(sformat* _ template target-field fields &amp; children)</code></div><div class="doc"><div class="markdown"></div></div><div class="src-link"><a href="https://github.com/mcorbin/mirabelle/blob/0.1.0-SNAPSHOT/src/clojure/mirabelle/action.clj#L1795">view source</a></div></div><div class="public anchor" id="var-split"><h3>split</h3><div class="usage"><code>(split &amp; clauses)</code></div><div class="doc"><div class="markdown"><p>Split by conditions.</p>
<pre><code>(split
  [:&gt; :metric 10] (debug)
  [:&gt; :metric 5] (info)
  (error)
</code></pre>
<p>In this example, all events with :metric &gt; 10 will go into the debug stream, all events with :metric &gt; 5 in the info stream, and other events will to the default stream which is “error”.</p>
<p>The default stream is optional, if not set all events not matching a condition will be discarded.</p></div></div><div class="src-link"><a href="https://github.com/mcorbin/mirabelle/blob/0.1.0-SNAPSHOT/src/clojure/mirabelle/action.clj#L985">view source</a></div></div><div class="public anchor" id="var-split*"><h3>split*</h3><div class="usage"><code>(split* _ clauses &amp; children)</code></div><div class="doc"><div class="markdown"></div></div><div class="src-link"><a href="https://github.com/mcorbin/mirabelle/blob/0.1.0-SNAPSHOT/src/clojure/mirabelle/action.clj#L968">view source</a></div></div><div class="public anchor" id="var-stream"><h3>stream</h3><div class="usage"><code>(stream config &amp; children)</code></div><div class="doc"><div class="markdown"><p>Creates a new stream. This action takes a map where the <code>:name</code> key, which will be the name of the stream, is mandatory.</p></div></div><div class="src-link"><a href="https://github.com/mcorbin/mirabelle/blob/0.1.0-SNAPSHOT/src/clojure/mirabelle/action.clj#L1678">view source</a></div></div><div class="public anchor" id="var-streams"><h3>streams</h3><div class="usage"><code>(streams &amp; streams)</code></div><div class="doc"><div class="markdown"><p>Entrypoint for all streams.</p>
<pre><code class="clojure">(streams
  (stream {:name :fobar}
    (info))
  (stream {:name :foo}
    (info)))
</code></pre></div></div><div class="src-link"><a href="https://github.com/mcorbin/mirabelle/blob/0.1.0-SNAPSHOT/src/clojure/mirabelle/action.clj#L1684">view source</a></div></div><div class="public anchor" id="var-tag"><h3>tag</h3><div class="usage"><code>(tag tags &amp; children)</code></div><div class="doc"><div class="markdown"><p>Adds a new tag, or set of tags, to events which flow through.</p>
<pre><code class="clojure">(tag "foo"
  (info))
</code></pre>
<p>This example adds the tag “foo” to events.</p>
<pre><code class="clojure">(tag ["foo" "bar"] (info))
</code></pre>
<p>This example adds the tag “foo” and “bar” to events.</p></div></div><div class="src-link"><a href="https://github.com/mcorbin/mirabelle/blob/0.1.0-SNAPSHOT/src/clojure/mirabelle/action.clj#L814">view source</a></div></div><div class="public anchor" id="var-tag*"><h3>tag*</h3><div class="usage"><code>(tag* _ tags &amp; children)</code></div><div class="doc"><div class="markdown"></div></div><div class="src-link"><a href="https://github.com/mcorbin/mirabelle/blob/0.1.0-SNAPSHOT/src/clojure/mirabelle/action.clj#L803">view source</a></div></div><div class="public anchor" id="var-tagged-all"><h3>tagged-all</h3><div class="usage"><code>(tagged-all tags &amp; children)</code></div><div class="doc"><div class="markdown"><p>Passes on events where all tags are present.</p>
<pre><code class="clojure">(tagged-all "foo"
  (info))
</code></pre>
<p>This example keeps only events tagged “foo”.</p>
<pre><code class="clojure">(tagged-all ["foo" "bar"] (info))
</code></pre>
<p>This example keeps only events tagged “foo” and “bar”.</p></div></div><div class="src-link"><a href="https://github.com/mcorbin/mirabelle/blob/0.1.0-SNAPSHOT/src/clojure/mirabelle/action.clj#L880">view source</a></div></div><div class="public anchor" id="var-tagged-all*"><h3>tagged-all*</h3><div class="usage"><code>(tagged-all* _ tags &amp; children)</code></div><div class="doc"><div class="markdown"></div></div><div class="src-link"><a href="https://github.com/mcorbin/mirabelle/blob/0.1.0-SNAPSHOT/src/clojure/mirabelle/action.clj#L868">view source</a></div></div><div class="public anchor" id="var-tap"><h3>tap</h3><div class="usage"><code>(tap tap-name)</code></div><div class="doc"><div class="markdown"><p>Save events into the tap. Noop outside tests.</p>
<pre><code class="clojure">(where [:= :service "foo"]
  (tap :foo)
</code></pre>
<p>In test mode, all events with <code>:service</code> “foo” will be saved in a tap named <code>:foo</code></p></div></div><div class="src-link"><a href="https://github.com/mcorbin/mirabelle/blob/0.1.0-SNAPSHOT/src/clojure/mirabelle/action.clj#L1589">view source</a></div></div><div class="public anchor" id="var-tap*"><h3>tap*</h3><div class="usage"><code>(tap* context tape-name)</code></div><div class="doc"><div class="markdown"></div></div><div class="src-link"><a href="https://github.com/mcorbin/mirabelle/blob/0.1.0-SNAPSHOT/src/clojure/mirabelle/action.clj#L1576">view source</a></div></div><div class="public anchor" id="var-test-action"><h3>test-action</h3><div class="usage"><code>(test-action state &amp; children)</code></div><div class="doc"><div class="markdown"><p>Bufferize all received events in the state (an atom) passed as parameter</p></div></div><div class="src-link"><a href="https://github.com/mcorbin/mirabelle/blob/0.1.0-SNAPSHOT/src/clojure/mirabelle/action.clj#L292">view source</a></div></div><div class="public anchor" id="var-test-action*"><h3>test-action*</h3><div class="usage"><code>(test-action* _ state)</code></div><div class="doc"><div class="markdown"></div></div><div class="src-link"><a href="https://github.com/mcorbin/mirabelle/blob/0.1.0-SNAPSHOT/src/clojure/mirabelle/action.clj#L287">view source</a></div></div><div class="public anchor" id="var-throttle"><h3>throttle</h3><div class="usage"><code>(throttle dt &amp; children)</code></div><div class="doc"><div class="markdown"><p>Let one event pass at most every dt seconds. Can be used for example to avoid sending to limit the number of alerts sent to an external system.</p>
<pre><code class="clojure">(throttle 10
  (alert))
</code></pre>
<p>In this example, throttle will let one event pass at most every 10 seconds. Other events, or events with no time, are filtered.</p></div></div><div class="src-link"><a href="https://github.com/mcorbin/mirabelle/blob/0.1.0-SNAPSHOT/src/clojure/mirabelle/action.clj#L1038">view source</a></div></div><div class="public anchor" id="var-throttle*"><h3>throttle*</h3><div class="usage"><code>(throttle* _ dt &amp; children)</code></div><div class="doc"><div class="markdown"></div></div><div class="src-link"><a href="https://github.com/mcorbin/mirabelle/blob/0.1.0-SNAPSHOT/src/clojure/mirabelle/action.clj#L1020">view source</a></div></div><div class="public anchor" id="var-to-base64"><h3>to-base64</h3><div class="usage"><code>(to-base64 field &amp; children)</code></div><div class="doc"><div class="markdown"><p>Convert a field or multiple fields to base64. Fields values should be string.</p>
<pre><code class="clojure">(sdo
  ;; you can pass one field
  (to-base64 :host)
  ;; or a list of fields
  (to-base64 [:host :service]))
</code></pre></div></div><div class="src-link"><a href="https://github.com/mcorbin/mirabelle/blob/0.1.0-SNAPSHOT/src/clojure/mirabelle/action.clj#L1750">view source</a></div></div><div class="public anchor" id="var-to-base64*"><h3>to-base64*</h3><div class="usage"><code>(to-base64* _ fields &amp; children)</code></div><div class="doc"><div class="markdown"></div></div><div class="src-link"><a href="https://github.com/mcorbin/mirabelle/blob/0.1.0-SNAPSHOT/src/clojure/mirabelle/action.clj#L1745">view source</a></div></div><div class="public anchor" id="var-under"><h3>under</h3><div class="usage"><code>(under n &amp; children)</code></div><div class="doc"><div class="markdown"><p>Passes on events only when their metric is greater than x.</p>
<pre><code class="clojure">(under 10
  (info))
</code></pre></div></div><div class="src-link"><a href="https://github.com/mcorbin/mirabelle/blob/0.1.0-SNAPSHOT/src/clojure/mirabelle/action.clj#L1217">view source</a></div></div><div class="public anchor" id="var-under*"><h3>under*</h3><div class="usage"><code>(under* _ n &amp; children)</code></div><div class="doc"><div class="markdown"></div></div><div class="src-link"><a href="https://github.com/mcorbin/mirabelle/blob/0.1.0-SNAPSHOT/src/clojure/mirabelle/action.clj#L1207">view source</a></div></div><div class="public anchor" id="var-untag"><h3>untag</h3><div class="usage"><code>(untag tags &amp; children)</code></div><div class="doc"><div class="markdown"><p>Removes a tag, or set of tags, from events which flow through.</p>
<pre><code class="clojure">(untag "foo" index)
</code></pre>
<p>This example removes the tag “foo” from events.</p>
<pre><code class="clojure">(untag ["foo" "bar"] index)
</code></pre>
<p>This example removes the tags “foo” and “bar” from events</p></div></div><div class="src-link"><a href="https://github.com/mcorbin/mirabelle/blob/0.1.0-SNAPSHOT/src/clojure/mirabelle/action.clj#L847">view source</a></div></div><div class="public anchor" id="var-untag*"><h3>untag*</h3><div class="usage"><code>(untag* _ tags &amp; children)</code></div><div class="doc"><div class="markdown"></div></div><div class="src-link"><a href="https://github.com/mcorbin/mirabelle/blob/0.1.0-SNAPSHOT/src/clojure/mirabelle/action.clj#L835">view source</a></div></div><div class="public anchor" id="var-warning"><h3>warning</h3><div class="usage"><code>(warning &amp; children)</code></div><div class="doc"><div class="markdown"><p>Keep all events in state warning.</p>
<pre><code class="clojure">(warning
  (warning))
</code></pre>
<p>In this example, all events with <code>:state</code> “warning” will be logged.</p></div></div><div class="src-link"><a href="https://github.com/mcorbin/mirabelle/blob/0.1.0-SNAPSHOT/src/clojure/mirabelle/action.clj#L551">view source</a></div></div><div class="public anchor" id="var-warning*"><h3>warning*</h3><div class="usage"><code>(warning* _ &amp; children)</code></div><div class="doc"><div class="markdown"></div></div><div class="src-link"><a href="https://github.com/mcorbin/mirabelle/blob/0.1.0-SNAPSHOT/src/clojure/mirabelle/action.clj#L545">view source</a></div></div><div class="public anchor" id="var-where"><h3>where</h3><div class="usage"><code>(where conditions &amp; children)</code></div><div class="doc"><div class="markdown"><p>Filter events based on conditions. Each condition is a vector composed of the function to apply on the field, the field to extract from the event, and the event itself. Multiple conditions can be added by using <code>:or</code> or <code>:and</code>.</p>
<pre><code class="clojure">(where [:= :metric 4])
</code></pre>
<p>Here, we keep only events where the :metric field is equal to 4.</p>
<pre><code class="clojure">(where [:and [:= :host "foo"]
             [:&gt; :metric 10])
</code></pre>
<p>Here, we keep only events with :host = foo and with :metric &gt; 10</p></div></div><div class="src-link"><a href="https://github.com/mcorbin/mirabelle/blob/0.1.0-SNAPSHOT/src/clojure/mirabelle/action.clj#L50">view source</a></div></div><div class="public anchor" id="var-where*"><h3>where*</h3><div class="usage"><code>(where* _ conditions &amp; children)</code></div><div class="doc"><div class="markdown"></div></div><div class="src-link"><a href="https://github.com/mcorbin/mirabelle/blob/0.1.0-SNAPSHOT/src/clojure/mirabelle/action.clj#L40">view source</a></div></div><div class="public anchor" id="var-with"><h3>with</h3><div class="usage"><code>(with &amp; args)</code></div><div class="doc"><div class="markdown"><p>Set an event field to the given value.</p>
<pre><code class="clojure">(with :state "critical"
  (debug))
</code></pre>
<p>This example set the field <code>:state</code> to “critical” for events.</p>
<p>A map can also be provided:</p>
<pre><code class="clojure">(with {:service "foo" :state "critical"}
  (debug))
</code></pre>
<p>This example set the the field <code>:service</code> to “foo” and the field <code>:state</code> to “critical” for events.</p></div></div><div class="src-link"><a href="https://github.com/mcorbin/mirabelle/blob/0.1.0-SNAPSHOT/src/clojure/mirabelle/action.clj#L716">view source</a></div></div><div class="public anchor" id="var-with*"><h3>with*</h3><div class="usage"><code>(with* _ fields &amp; children)</code></div><div class="doc"><div class="markdown"></div></div><div class="src-link"><a href="https://github.com/mcorbin/mirabelle/blob/0.1.0-SNAPSHOT/src/clojure/mirabelle/action.clj#L711">view source</a></div></div></div></body></html>