<!DOCTYPE html PUBLIC ""
    "">
<html><head><meta charset="UTF-8" /><title>mirabelle.action documentation</title><link rel="stylesheet" type="text/css" href="css/default.css" /><link rel="stylesheet" type="text/css" href="css/highlight.css" /><script type="text/javascript" src="js/highlight.min.js"></script><script type="text/javascript" src="js/jquery.min.js"></script><script type="text/javascript" src="js/page_effects.js"></script><script>hljs.initHighlightingOnLoad();</script></head><body><div id="header"><h2>Generated by <a href="https://github.com/weavejester/codox">Codox</a></h2><h1><a href="index.html"><span class="project-title"><span class="project-name">Mirabelle</span> <span class="project-version">0.1.0-SNAPSHOT</span></span></a></h1></div><div class="sidebar primary"><h3 class="no-link"><span class="inner">Project</span></h3><ul class="index-link"><li class="depth-1 "><a href="index.html"><div class="inner">Index</div></a></li></ul><h3 class="no-link"><span class="inner">Namespaces</span></h3><ul><li class="depth-1"><div class="no-link"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>mirabelle</span></div></div></li><li class="depth-2 branch current"><a href="mirabelle.action.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>action</span></div></a></li><li class="depth-2 branch"><a href="mirabelle.config.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>config</span></div></a></li><li class="depth-2 branch"><a href="mirabelle.core.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>core</span></div></a></li><li class="depth-2"><div class="no-link"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>db</span></div></div></li><li class="depth-3 branch"><a href="mirabelle.db.memtable.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>memtable</span></div></a></li><li class="depth-3"><a href="mirabelle.db.queue.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>queue</span></div></a></li><li class="depth-2 branch"><a href="mirabelle.event.html"><div class="inner"><span class="tree" style="top: -83px;"><span class="top" style="height: 92px;"></span><span class="bottom"></span></span><span>event</span></div></a></li><li class="depth-2 branch"><a href="mirabelle.handler.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>handler</span></div></a></li><li class="depth-2 branch"><a href="mirabelle.http.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>http</span></div></a></li><li class="depth-2"><div class="no-link"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>interceptor</span></div></div></li><li class="depth-3"><a href="mirabelle.interceptor.route.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>route</span></div></a></li><li class="depth-2"><a href="mirabelle.io.html"><div class="inner"><span class="tree" style="top: -52px;"><span class="top" style="height: 61px;"></span><span class="bottom"></span></span><span>io</span></div></a></li><li class="depth-3"><a href="mirabelle.io.file.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>file</span></div></a></li><li class="depth-2 branch"><a href="mirabelle.math.html"><div class="inner"><span class="tree" style="top: -52px;"><span class="top" style="height: 61px;"></span><span class="bottom"></span></span><span>math</span></div></a></li><li class="depth-2 branch"><a href="mirabelle.pool.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>pool</span></div></a></li><li class="depth-2 branch"><a href="mirabelle.spec.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>spec</span></div></a></li><li class="depth-2 branch"><a href="mirabelle.stream.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>stream</span></div></a></li><li class="depth-2 branch"><a href="mirabelle.time.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>time</span></div></a></li><li class="depth-2"><a href="mirabelle.transport.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>transport</span></div></a></li><li class="depth-3"><a href="mirabelle.transport.tcp.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>tcp</span></div></a></li><li class="depth-1"><a href="user.html"><div class="inner"><span class="tree" style="top: -641px;"><span class="top" style="height: 650px;"></span><span class="bottom"></span></span><span>user</span></div></a></li></ul></div><div class="sidebar secondary"><h3><a href="#top"><span class="inner">Public Vars</span></a></h3><ul><li class="depth-1"><a href="mirabelle.action.html#var-above-dt"><div class="inner"><span>above-dt</span></div></a></li><li class="depth-1"><a href="mirabelle.action.html#var-action-.3Efn"><div class="inner"><span>action-&gt;fn</span></div></a></li><li class="depth-1"><a href="mirabelle.action.html#var-below-dt"><div class="inner"><span>below-dt</span></div></a></li><li class="depth-1"><a href="mirabelle.action.html#var-between-dt"><div class="inner"><span>between-dt</span></div></a></li><li class="depth-1"><a href="mirabelle.action.html#var-by"><div class="inner"><span>by</span></div></a></li><li class="depth-1"><a href="mirabelle.action.html#var-by-fn"><div class="inner"><span>by-fn</span></div></a></li><li class="depth-1"><a href="mirabelle.action.html#var-call-rescue"><div class="inner"><span>call-rescue</span></div></a></li><li class="depth-1"><a href="mirabelle.action.html#var-changed"><div class="inner"><span>changed</span></div></a></li><li class="depth-1"><a href="mirabelle.action.html#var-changed*"><div class="inner"><span>changed*</span></div></a></li><li class="depth-1"><a href="mirabelle.action.html#var-coalesce"><div class="inner"><span>coalesce</span></div></a></li><li class="depth-1"><a href="mirabelle.action.html#var-coalesce*"><div class="inner"><span>coalesce*</span></div></a></li><li class="depth-1"><a href="mirabelle.action.html#var-coll-count"><div class="inner"><span>coll-count</span></div></a></li><li class="depth-1"><a href="mirabelle.action.html#var-coll-count*"><div class="inner"><span>coll-count*</span></div></a></li><li class="depth-1"><a href="mirabelle.action.html#var-coll-max"><div class="inner"><span>coll-max</span></div></a></li><li class="depth-1"><a href="mirabelle.action.html#var-coll-max*"><div class="inner"><span>coll-max*</span></div></a></li><li class="depth-1"><a href="mirabelle.action.html#var-coll-mean"><div class="inner"><span>coll-mean</span></div></a></li><li class="depth-1"><a href="mirabelle.action.html#var-coll-mean*"><div class="inner"><span>coll-mean*</span></div></a></li><li class="depth-1"><a href="mirabelle.action.html#var-coll-min"><div class="inner"><span>coll-min</span></div></a></li><li class="depth-1"><a href="mirabelle.action.html#var-coll-min*"><div class="inner"><span>coll-min*</span></div></a></li><li class="depth-1"><a href="mirabelle.action.html#var-coll-rate"><div class="inner"><span>coll-rate</span></div></a></li><li class="depth-1"><a href="mirabelle.action.html#var-coll-rate*"><div class="inner"><span>coll-rate*</span></div></a></li><li class="depth-1"><a href="mirabelle.action.html#var-compile-condition"><div class="inner"><span>compile-condition</span></div></a></li><li class="depth-1"><a href="mirabelle.action.html#var-compile-conditions"><div class="inner"><span>compile-conditions</span></div></a></li><li class="depth-1"><a href="mirabelle.action.html#var-cond-dt*"><div class="inner"><span>cond-dt*</span></div></a></li><li class="depth-1"><a href="mirabelle.action.html#var-condition-.3Efn"><div class="inner"><span>condition-&gt;fn</span></div></a></li><li class="depth-1"><a href="mirabelle.action.html#var-critical"><div class="inner"><span>critical</span></div></a></li><li class="depth-1"><a href="mirabelle.action.html#var-critical*"><div class="inner"><span>critical*</span></div></a></li><li class="depth-1"><a href="mirabelle.action.html#var-critical-dt"><div class="inner"><span>critical-dt</span></div></a></li><li class="depth-1"><a href="mirabelle.action.html#var-ddt"><div class="inner"><span>ddt</span></div></a></li><li class="depth-1"><a href="mirabelle.action.html#var-ddt*"><div class="inner"><span>ddt*</span></div></a></li><li class="depth-1"><a href="mirabelle.action.html#var-ddt-pos"><div class="inner"><span>ddt-pos</span></div></a></li><li class="depth-1"><a href="mirabelle.action.html#var-debug"><div class="inner"><span>debug</span></div></a></li><li class="depth-1"><a href="mirabelle.action.html#var-debug*"><div class="inner"><span>debug*</span></div></a></li><li class="depth-1"><a href="mirabelle.action.html#var-decrement"><div class="inner"><span>decrement</span></div></a></li><li class="depth-1"><a href="mirabelle.action.html#var-decrement*"><div class="inner"><span>decrement*</span></div></a></li><li class="depth-1"><a href="mirabelle.action.html#var-default"><div class="inner"><span>default</span></div></a></li><li class="depth-1"><a href="mirabelle.action.html#var-default*"><div class="inner"><span>default*</span></div></a></li><li class="depth-1"><a href="mirabelle.action.html#var-discard-fn"><div class="inner"><span>discard-fn</span></div></a></li><li class="depth-1"><a href="mirabelle.action.html#var-error"><div class="inner"><span>error</span></div></a></li><li class="depth-1"><a href="mirabelle.action.html#var-error*"><div class="inner"><span>error*</span></div></a></li><li class="depth-1"><a href="mirabelle.action.html#var-ewma-timeless"><div class="inner"><span>ewma-timeless</span></div></a></li><li class="depth-1"><a href="mirabelle.action.html#var-ewma-timeless*"><div class="inner"><span>ewma-timeless*</span></div></a></li><li class="depth-1"><a href="mirabelle.action.html#var-expired"><div class="inner"><span>expired</span></div></a></li><li class="depth-1"><a href="mirabelle.action.html#var-expired*"><div class="inner"><span>expired*</span></div></a></li><li class="depth-1"><a href="mirabelle.action.html#var-fixed-event-window"><div class="inner"><span>fixed-event-window</span></div></a></li><li class="depth-1"><a href="mirabelle.action.html#var-fixed-event-window*"><div class="inner"><span>fixed-event-window*</span></div></a></li><li class="depth-1"><a href="mirabelle.action.html#var-fixed-time-window"><div class="inner"><span>fixed-time-window</span></div></a></li><li class="depth-1"><a href="mirabelle.action.html#var-fixed-time-window*"><div class="inner"><span>fixed-time-window*</span></div></a></li><li class="depth-1"><a href="mirabelle.action.html#var-increment"><div class="inner"><span>increment</span></div></a></li><li class="depth-1"><a href="mirabelle.action.html#var-increment*"><div class="inner"><span>increment*</span></div></a></li><li class="depth-1"><a href="mirabelle.action.html#var-index.21"><div class="inner"><span>index!</span></div></a></li><li class="depth-1"><a href="mirabelle.action.html#var-index.21*"><div class="inner"><span>index!*</span></div></a></li><li class="depth-1"><a href="mirabelle.action.html#var-info"><div class="inner"><span>info</span></div></a></li><li class="depth-1"><a href="mirabelle.action.html#var-info*"><div class="inner"><span>info*</span></div></a></li><li class="depth-1"><a href="mirabelle.action.html#var-keep-non-discarded-events"><div class="inner"><span>keep-non-discarded-events</span></div></a></li><li class="depth-1"><a href="mirabelle.action.html#var-moving-event-window"><div class="inner"><span>moving-event-window</span></div></a></li><li class="depth-1"><a href="mirabelle.action.html#var-moving-event-window*"><div class="inner"><span>moving-event-window*</span></div></a></li><li class="depth-1"><a href="mirabelle.action.html#var-not-expired"><div class="inner"><span>not-expired</span></div></a></li><li class="depth-1"><a href="mirabelle.action.html#var-not-expired*"><div class="inner"><span>not-expired*</span></div></a></li><li class="depth-1"><a href="mirabelle.action.html#var-outside-dt"><div class="inner"><span>outside-dt</span></div></a></li><li class="depth-1"><a href="mirabelle.action.html#var-over"><div class="inner"><span>over</span></div></a></li><li class="depth-1"><a href="mirabelle.action.html#var-over*"><div class="inner"><span>over*</span></div></a></li><li class="depth-1"><a href="mirabelle.action.html#var-percentiles"><div class="inner"><span>percentiles</span></div></a></li><li class="depth-1"><a href="mirabelle.action.html#var-percentiles*"><div class="inner"><span>percentiles*</span></div></a></li><li class="depth-1"><a href="mirabelle.action.html#var-project*"><div class="inner"><span>project*</span></div></a></li><li class="depth-1"><a href="mirabelle.action.html#var-push-io.21"><div class="inner"><span>push-io!</span></div></a></li><li class="depth-1"><a href="mirabelle.action.html#var-push-io.21*"><div class="inner"><span>push-io!*</span></div></a></li><li class="depth-1"><a href="mirabelle.action.html#var-reinject.21"><div class="inner"><span>reinject!</span></div></a></li><li class="depth-1"><a href="mirabelle.action.html#var-reinject.21*"><div class="inner"><span>reinject!*</span></div></a></li><li class="depth-1"><a href="mirabelle.action.html#var-scale"><div class="inner"><span>scale</span></div></a></li><li class="depth-1"><a href="mirabelle.action.html#var-scale*"><div class="inner"><span>scale*</span></div></a></li><li class="depth-1"><a href="mirabelle.action.html#var-sdissoc"><div class="inner"><span>sdissoc</span></div></a></li><li class="depth-1"><a href="mirabelle.action.html#var-sdissoc*"><div class="inner"><span>sdissoc*</span></div></a></li><li class="depth-1"><a href="mirabelle.action.html#var-sdo"><div class="inner"><span>sdo</span></div></a></li><li class="depth-1"><a href="mirabelle.action.html#var-sdo*"><div class="inner"><span>sdo*</span></div></a></li><li class="depth-1"><a href="mirabelle.action.html#var-sflatten"><div class="inner"><span>sflatten</span></div></a></li><li class="depth-1"><a href="mirabelle.action.html#var-sflatten*"><div class="inner"><span>sflatten*</span></div></a></li><li class="depth-1"><a href="mirabelle.action.html#var-split"><div class="inner"><span>split</span></div></a></li><li class="depth-1"><a href="mirabelle.action.html#var-split*"><div class="inner"><span>split*</span></div></a></li><li class="depth-1"><a href="mirabelle.action.html#var-tag"><div class="inner"><span>tag</span></div></a></li><li class="depth-1"><a href="mirabelle.action.html#var-tag*"><div class="inner"><span>tag*</span></div></a></li><li class="depth-1"><a href="mirabelle.action.html#var-tagged-all"><div class="inner"><span>tagged-all</span></div></a></li><li class="depth-1"><a href="mirabelle.action.html#var-tagged-all*"><div class="inner"><span>tagged-all*</span></div></a></li><li class="depth-1"><a href="mirabelle.action.html#var-test-action"><div class="inner"><span>test-action</span></div></a></li><li class="depth-1"><a href="mirabelle.action.html#var-test-action*"><div class="inner"><span>test-action*</span></div></a></li><li class="depth-1"><a href="mirabelle.action.html#var-throttle"><div class="inner"><span>throttle</span></div></a></li><li class="depth-1"><a href="mirabelle.action.html#var-throttle*"><div class="inner"><span>throttle*</span></div></a></li><li class="depth-1"><a href="mirabelle.action.html#var-under"><div class="inner"><span>under</span></div></a></li><li class="depth-1"><a href="mirabelle.action.html#var-under*"><div class="inner"><span>under*</span></div></a></li><li class="depth-1"><a href="mirabelle.action.html#var-untag"><div class="inner"><span>untag</span></div></a></li><li class="depth-1"><a href="mirabelle.action.html#var-untag*"><div class="inner"><span>untag*</span></div></a></li><li class="depth-1"><a href="mirabelle.action.html#var-valid-condition.3F"><div class="inner"><span>valid-condition?</span></div></a></li><li class="depth-1"><a href="mirabelle.action.html#var-warning"><div class="inner"><span>warning</span></div></a></li><li class="depth-1"><a href="mirabelle.action.html#var-warning*"><div class="inner"><span>warning*</span></div></a></li><li class="depth-1"><a href="mirabelle.action.html#var-where"><div class="inner"><span>where</span></div></a></li><li class="depth-1"><a href="mirabelle.action.html#var-where*"><div class="inner"><span>where*</span></div></a></li><li class="depth-1"><a href="mirabelle.action.html#var-with"><div class="inner"><span>with</span></div></a></li><li class="depth-1"><a href="mirabelle.action.html#var-with*"><div class="inner"><span>with*</span></div></a></li><li class="depth-1"><a href="mirabelle.action.html#var-write.21"><div class="inner"><span>write!</span></div></a></li><li class="depth-1"><a href="mirabelle.action.html#var-write.21*"><div class="inner"><span>write!*</span></div></a></li></ul></div><div class="namespace-docs" id="content"><h1 class="anchor" id="top">mirabelle.action</h1><div class="doc"><div class="markdown"></div></div><div class="public anchor" id="var-above-dt"><h3>above-dt</h3><div class="usage"><code>(above-dt threshold dt &amp; children)</code></div><div class="doc"><div class="markdown"><p>Takes a number <code>threshold</code> and a time period in seconds <code>dt</code>. If the condition <code>the event metric is &gt; to the threshold</code> is valid for all events received during at least the period <code>dt</code>, valid events received after the <code>dt</code> period will be passed on until an invalid event arrives. <code>:metric</code> should not be nil (it will produce exceptions).</p></div></div><div class="src-link"><a href="https://github.com/mcorbin/mirabelle/blob/0.1.0-SNAPSHOT/src/clojure/mirabelle/action.clj#L401">view source</a></div></div><div class="public anchor" id="var-action-.3Efn"><h3>action-&gt;fn</h3><div class="usage"></div><div class="doc"><div class="markdown"></div></div><div class="src-link"><a href="https://github.com/mcorbin/mirabelle/blob/0.1.0-SNAPSHOT/src/clojure/mirabelle/action.clj#L1331">view source</a></div></div><div class="public anchor" id="var-below-dt"><h3>below-dt</h3><div class="usage"><code>(below-dt threshold dt &amp; children)</code></div><div class="doc"><div class="markdown"><p>Takes a number <code>threshold</code> and a time period in seconds <code>dt</code>. If the condition <code>the event metric is &lt; to the threshold</code> is valid for all events received during at least the period <code>dt</code>, valid events received after the <code>dt</code> period will be passed on until an invalid event arrives. <code>:metric</code> should not be nil (it will produce exceptions).</p></div></div><div class="src-link"><a href="https://github.com/mcorbin/mirabelle/blob/0.1.0-SNAPSHOT/src/clojure/mirabelle/action.clj#L415">view source</a></div></div><div class="public anchor" id="var-between-dt"><h3>between-dt</h3><div class="usage"><code>(between-dt low high dt &amp; children)</code></div><div class="doc"><div class="markdown"><p>Takes two numbers, <code>low</code> and <code>high</code>, and a time period in seconds, <code>dt</code>. If the condition <code>the event metric is &gt; low and &lt; high</code> is valid for all events received during at least the period <code>dt</code>, valid events received after the <code>dt</code> period will be passed on until an invalid event arrives. <code>:metric</code> should not be nil (it will produce exceptions).</p></div></div><div class="src-link"><a href="https://github.com/mcorbin/mirabelle/blob/0.1.0-SNAPSHOT/src/clojure/mirabelle/action.clj#L429">view source</a></div></div><div class="public anchor" id="var-by"><h3>by</h3><div class="usage"><code>(by fields &amp; children)</code></div><div class="doc"><div class="markdown"><p>Split stream by field Every time an event arrives with a new value of field, this action invokes its child forms to return a <em>new</em>, distinct set of streams for that particular value.</p>
<pre><code class="clojure">(by [:host :service]
  (moving-time-window 5))
</code></pre>
<p>Generates a moving window for each host/service combination.</p></div></div><div class="src-link"><a href="https://github.com/mcorbin/mirabelle/blob/0.1.0-SNAPSHOT/src/clojure/mirabelle/action.clj#L1285">view source</a></div></div><div class="public anchor" id="var-by-fn"><h3>by-fn</h3><div class="usage"><code>(by-fn fields new-fork)</code></div><div class="doc"><div class="markdown"></div></div><div class="src-link"><a href="https://github.com/mcorbin/mirabelle/blob/0.1.0-SNAPSHOT/src/clojure/mirabelle/action.clj#L1269">view source</a></div></div><div class="public anchor" id="var-call-rescue"><h3>call-rescue</h3><div class="usage"><code>(call-rescue event children)</code></div><div class="doc"><div class="markdown"></div></div><div class="src-link"><a href="https://github.com/mcorbin/mirabelle/blob/0.1.0-SNAPSHOT/src/clojure/mirabelle/action.clj#L13">view source</a></div></div><div class="public anchor" id="var-changed"><h3>changed</h3><div class="usage"><code>(changed field init &amp; children)</code></div><div class="doc"><div class="markdown"><p>Passes on events only if the <code>field</code> passed as parameter differs from the previous one. The <code>init</code> parameter is the default value for the stream.</p>
<pre><code class="clojure">(changed :state "ok")
</code></pre>
<p>For example, this action will let event pass if the :state field vary, the initial value being <code>ok</code>.</p>
<p>This stream is useful to get only events making a transition.</p></div></div><div class="src-link"><a href="https://github.com/mcorbin/mirabelle/blob/0.1.0-SNAPSHOT/src/clojure/mirabelle/action.clj#L1098">view source</a></div></div><div class="public anchor" id="var-changed*"><h3>changed*</h3><div class="usage"><code>(changed* _ field init &amp; children)</code></div><div class="doc"><div class="markdown"></div></div><div class="src-link"><a href="https://github.com/mcorbin/mirabelle/blob/0.1.0-SNAPSHOT/src/clojure/mirabelle/action.clj#L1082">view source</a></div></div><div class="public anchor" id="var-coalesce"><h3>coalesce</h3><div class="usage"><code>(coalesce dt fields &amp; children)</code></div><div class="doc"><div class="markdown"><p>Returns a list of the latest non-expired events (by <code>fields</code>) every dt seconds (at best).</p>
<pre><code class="clojure">(coalesce 10 [:host "service"]
  (debug)
</code></pre>
<p>In this example, the latest event for each host/service combination will be kept and forwarded downstream. Expired events will be removed from the list.</p></div></div><div class="src-link"><a href="https://github.com/mcorbin/mirabelle/blob/0.1.0-SNAPSHOT/src/clojure/mirabelle/action.clj#L612">view source</a></div></div><div class="public anchor" id="var-coalesce*"><h3>coalesce*</h3><div class="usage"><code>(coalesce* _ dt fields &amp; children)</code></div><div class="doc"><div class="markdown"></div></div><div class="src-link"><a href="https://github.com/mcorbin/mirabelle/blob/0.1.0-SNAPSHOT/src/clojure/mirabelle/action.clj#L541">view source</a></div></div><div class="public anchor" id="var-coll-count"><h3>coll-count</h3><div class="usage"><code>(coll-count &amp; children)</code></div><div class="doc"><div class="markdown"><p>Count the number of events. Should receive a list of events from the previous stream. The most recent event is used as a base to create the new event, and its :metric field is set to the number of events received as input.</p></div></div><div class="src-link"><a href="https://github.com/mcorbin/mirabelle/blob/0.1.0-SNAPSHOT/src/clojure/mirabelle/action.clj#L1208">view source</a></div></div><div class="public anchor" id="var-coll-count*"><h3>coll-count*</h3><div class="usage"><code>(coll-count* _ &amp; children)</code></div><div class="doc"><div class="markdown"></div></div><div class="src-link"><a href="https://github.com/mcorbin/mirabelle/blob/0.1.0-SNAPSHOT/src/clojure/mirabelle/action.clj#L1200">view source</a></div></div><div class="public anchor" id="var-coll-max"><h3>coll-max</h3><div class="usage"><code>(coll-max &amp; children)</code></div><div class="doc"><div class="markdown"><p>Returns the event with the biggest metric. Should receive a list of events from the previous stream.</p>
<pre><code class="clojure">(fixed-event-window 10
  (coll-max
    (debug)))
</code></pre>
<p>Get the event the biggest metric on windows of 10 events</p></div></div><div class="src-link"><a href="https://github.com/mcorbin/mirabelle/blob/0.1.0-SNAPSHOT/src/clojure/mirabelle/action.clj#L253">view source</a></div></div><div class="public anchor" id="var-coll-max*"><h3>coll-max*</h3><div class="usage"><code>(coll-max* _ &amp; children)</code></div><div class="doc"><div class="markdown"></div></div><div class="src-link"><a href="https://github.com/mcorbin/mirabelle/blob/0.1.0-SNAPSHOT/src/clojure/mirabelle/action.clj#L248">view source</a></div></div><div class="public anchor" id="var-coll-mean"><h3>coll-mean</h3><div class="usage"><code>(coll-mean &amp; children)</code></div><div class="doc"><div class="markdown"><p>Computes the events mean (on metric). Should receive a list of events from the previous stream. The most recent event is used as a base to create the new event</p>
<pre><code class="clojure">(fixed-event-window 10
  (coll-mean
    (debug)))
</code></pre>
<p>Computes the mean on windows of 10 events</p></div></div><div class="src-link"><a href="https://github.com/mcorbin/mirabelle/blob/0.1.0-SNAPSHOT/src/clojure/mirabelle/action.clj#L232">view source</a></div></div><div class="public anchor" id="var-coll-mean*"><h3>coll-mean*</h3><div class="usage"><code>(coll-mean* _ &amp; children)</code></div><div class="doc"><div class="markdown"></div></div><div class="src-link"><a href="https://github.com/mcorbin/mirabelle/blob/0.1.0-SNAPSHOT/src/clojure/mirabelle/action.clj#L227">view source</a></div></div><div class="public anchor" id="var-coll-min"><h3>coll-min</h3><div class="usage"><code>(coll-min &amp; children)</code></div><div class="doc"><div class="markdown"><p>Returns the event with the smallest metric. Should receive a list of events from the previous stream.</p>
<pre><code class="clojure">(fixed-event-window 10
  (coll-min
    (debug)))
</code></pre>
<p>Get the event the smallest metric on windows of 10 events</p></div></div><div class="src-link"><a href="https://github.com/mcorbin/mirabelle/blob/0.1.0-SNAPSHOT/src/clojure/mirabelle/action.clj#L273">view source</a></div></div><div class="public anchor" id="var-coll-min*"><h3>coll-min*</h3><div class="usage"><code>(coll-min* _ &amp; children)</code></div><div class="doc"><div class="markdown"></div></div><div class="src-link"><a href="https://github.com/mcorbin/mirabelle/blob/0.1.0-SNAPSHOT/src/clojure/mirabelle/action.clj#L268">view source</a></div></div><div class="public anchor" id="var-coll-rate"><h3>coll-rate</h3><div class="usage"><code>(coll-rate &amp; children)</code></div><div class="doc"><div class="markdown"><p>Computes the rate on a list of events. Should receive a list of events from the previous stream. The latest event is used as a base to build the new event.</p>
<pre><code class="clojure">(fixed-event-window 3
  (coll-rate
    (debug)))
</code></pre>
<p>If this example receives the events:</p>
<p>{:metric 1 :time 1} {:metric 2 :time 2} {:metric 1 :time 3}</p>
<p>The stream will return {:metric 2 :time 3}</p>
<p>Indeed, (1+2+1)/2 = 3 (we divide by 2 because we have 2 seconds between the min and max events time).</p></div></div><div class="src-link"><a href="https://github.com/mcorbin/mirabelle/blob/0.1.0-SNAPSHOT/src/clojure/mirabelle/action.clj#L673">view source</a></div></div><div class="public anchor" id="var-coll-rate*"><h3>coll-rate*</h3><div class="usage"><code>(coll-rate* _ &amp; children)</code></div><div class="doc"><div class="markdown"></div></div><div class="src-link"><a href="https://github.com/mcorbin/mirabelle/blob/0.1.0-SNAPSHOT/src/clojure/mirabelle/action.clj#L668">view source</a></div></div><div class="public anchor" id="var-compile-condition"><h3>compile-condition</h3><div class="usage"><code>(compile-condition [condition field &amp; args])</code></div><div class="doc"><div class="markdown"></div></div><div class="src-link"><a href="https://github.com/mcorbin/mirabelle/blob/0.1.0-SNAPSHOT/src/clojure/mirabelle/action.clj#L54">view source</a></div></div><div class="public anchor" id="var-compile-conditions"><h3>compile-conditions</h3><div class="usage"><code>(compile-conditions conditions)</code></div><div class="doc"><div class="markdown"><p>Takes a condition and returns a function which can be applied to an event to check if the condition is valid for this event</p></div></div><div class="src-link"><a href="https://github.com/mcorbin/mirabelle/blob/0.1.0-SNAPSHOT/src/clojure/mirabelle/action.clj#L65">view source</a></div></div><div class="public anchor" id="var-cond-dt*"><h3>cond-dt*</h3><div class="usage"><code>(cond-dt* _ conditions dt &amp; children)</code></div><div class="doc"><div class="markdown"><p>A stream which detects if a condition <code>(f event)</code> is true during <code>dt</code> seconds. Takes <code>conditions</code> (like in the where action) and a time period <code>dt</code> in seconds. If the condition is valid for all events received during at least the period <code>dt</code>, valid events received after the <code>dt</code> period will be passed on until an invalid event arrives. Skips events that are too old or that do not have a timestamp.</p></div></div><div class="src-link"><a href="https://github.com/mcorbin/mirabelle/blob/0.1.0-SNAPSHOT/src/clojure/mirabelle/action.clj#L360">view source</a></div></div><div class="public anchor" id="var-condition-.3Efn"><h3>condition-&gt;fn</h3><div class="usage"></div><div class="doc"><div class="markdown"><p>Map containing the functions associated to the where options</p></div></div><div class="src-link"><a href="https://github.com/mcorbin/mirabelle/blob/0.1.0-SNAPSHOT/src/clojure/mirabelle/action.clj#L18">view source</a></div></div><div class="public anchor" id="var-critical"><h3>critical</h3><div class="usage"><code>(critical &amp; children)</code></div><div class="doc"><div class="markdown"><p>Keep all events in state critical</p></div></div><div class="src-link"><a href="https://github.com/mcorbin/mirabelle/blob/0.1.0-SNAPSHOT/src/clojure/mirabelle/action.clj#L481">view source</a></div></div><div class="public anchor" id="var-critical*"><h3>critical*</h3><div class="usage"><code>(critical* _ &amp; children)</code></div><div class="doc"><div class="markdown"></div></div><div class="src-link"><a href="https://github.com/mcorbin/mirabelle/blob/0.1.0-SNAPSHOT/src/clojure/mirabelle/action.clj#L475">view source</a></div></div><div class="public anchor" id="var-critical-dt"><h3>critical-dt</h3><div class="usage"><code>(critical-dt dt &amp; children)</code></div><div class="doc"><div class="markdown"><p>Takes a time period in seconds <code>dt</code>. If all events received during at least the period <code>dt</code> have <code>:state</code> critical, new critical events received after the <code>dt</code> period will be passed on until an invalid event arrives.</p></div></div><div class="src-link"><a href="https://github.com/mcorbin/mirabelle/blob/0.1.0-SNAPSHOT/src/clojure/mirabelle/action.clj#L463">view source</a></div></div><div class="public anchor" id="var-ddt"><h3>ddt</h3><div class="usage"><code>(ddt &amp; children)</code></div><div class="doc"><div class="markdown"><p>Differentiate metrics with respect to time. Takes an optional number followed by child streams. Emits an event for each event received, but with metric equal to the difference between the current event and the previous one, divided by the difference in their times. Skips events without metrics.</p></div></div><div class="src-link"><a href="https://github.com/mcorbin/mirabelle/blob/0.1.0-SNAPSHOT/src/clojure/mirabelle/action.clj#L804">view source</a></div></div><div class="public anchor" id="var-ddt*"><h3>ddt*</h3><div class="usage"><code>(ddt* _ remove-neg? &amp; children)</code></div><div class="doc"><div class="markdown"></div></div><div class="src-link"><a href="https://github.com/mcorbin/mirabelle/blob/0.1.0-SNAPSHOT/src/clojure/mirabelle/action.clj#L789">view source</a></div></div><div class="public anchor" id="var-ddt-pos"><h3>ddt-pos</h3><div class="usage"><code>(ddt-pos &amp; children)</code></div><div class="doc"><div class="markdown"><p>Like ddt but do not forward events with negative metrics. This can be used for counters which may be reseted to zero for example.</p></div></div><div class="src-link"><a href="https://github.com/mcorbin/mirabelle/blob/0.1.0-SNAPSHOT/src/clojure/mirabelle/action.clj#L815">view source</a></div></div><div class="public anchor" id="var-debug"><h3>debug</h3><div class="usage"><code>(debug &amp; children)</code></div><div class="doc"><div class="markdown"><p>Print the event in the logs using the debug level</p>
<pre><code class="clojure">(increment
  (debug))
</code></pre></div></div><div class="src-link"><a href="https://github.com/mcorbin/mirabelle/blob/0.1.0-SNAPSHOT/src/clojure/mirabelle/action.clj#L152">view source</a></div></div><div class="public anchor" id="var-debug*"><h3>debug*</h3><div class="usage"><code>(debug* _ &amp; children)</code></div><div class="doc"><div class="markdown"></div></div><div class="src-link"><a href="https://github.com/mcorbin/mirabelle/blob/0.1.0-SNAPSHOT/src/clojure/mirabelle/action.clj#L146">view source</a></div></div><div class="public anchor" id="var-decrement"><h3>decrement</h3><div class="usage"><code>(decrement &amp; children)</code></div><div class="doc"><div class="markdown"><p>Decrement the event :metric field.</p></div></div><div class="src-link"><a href="https://github.com/mcorbin/mirabelle/blob/0.1.0-SNAPSHOT/src/clojure/mirabelle/action.clj#L140">view source</a></div></div><div class="public anchor" id="var-decrement*"><h3>decrement*</h3><div class="usage"><code>(decrement* _ &amp; children)</code></div><div class="doc"><div class="markdown"></div></div><div class="src-link"><a href="https://github.com/mcorbin/mirabelle/blob/0.1.0-SNAPSHOT/src/clojure/mirabelle/action.clj#L134">view source</a></div></div><div class="public anchor" id="var-default"><h3>default</h3><div class="usage"><code>(default field value &amp; children)</code></div><div class="doc"><div class="markdown"><p>Set a default value for an event</p></div></div><div class="src-link"><a href="https://github.com/mcorbin/mirabelle/blob/0.1.0-SNAPSHOT/src/clojure/mirabelle/action.clj#L508">view source</a></div></div><div class="public anchor" id="var-default*"><h3>default*</h3><div class="usage"><code>(default* _ field value &amp; children)</code></div><div class="doc"><div class="markdown"></div></div><div class="src-link"><a href="https://github.com/mcorbin/mirabelle/blob/0.1.0-SNAPSHOT/src/clojure/mirabelle/action.clj#L499">view source</a></div></div><div class="public anchor" id="var-discard-fn"><h3>discard-fn</h3><div class="usage"><code>(discard-fn t)</code></div><div class="doc"><div class="markdown"></div></div><div class="src-link"><a href="https://github.com/mcorbin/mirabelle/blob/0.1.0-SNAPSHOT/src/clojure/mirabelle/action.clj#L516">view source</a></div></div><div class="public anchor" id="var-error"><h3>error</h3><div class="usage"><code>(error &amp; children)</code></div><div class="doc"><div class="markdown"><p>Print the event in the logs using the error level</p>
<pre><code class="clojure">(increment
  (debug))
</code></pre></div></div><div class="src-link"><a href="https://github.com/mcorbin/mirabelle/blob/0.1.0-SNAPSHOT/src/clojure/mirabelle/action.clj#L186">view source</a></div></div><div class="public anchor" id="var-error*"><h3>error*</h3><div class="usage"><code>(error* _ &amp; children)</code></div><div class="doc"><div class="markdown"></div></div><div class="src-link"><a href="https://github.com/mcorbin/mirabelle/blob/0.1.0-SNAPSHOT/src/clojure/mirabelle/action.clj#L180">view source</a></div></div><div class="public anchor" id="var-ewma-timeless"><h3>ewma-timeless</h3><div class="usage"><code>(ewma-timeless r &amp; children)</code></div><div class="doc"><div class="markdown"><p>Exponential weighted moving average. Constant space and time overhead. Passes on each event received, but with metric adjusted to the moving average. Does not take the time between events into account. R is the ratio between successive events: r=1 means always return the most recent metric; r=1/2 means the current event counts for half, the previous event for 1/4, the previous event for 1/8, and so on.</p></div></div><div class="src-link"><a href="https://github.com/mcorbin/mirabelle/blob/0.1.0-SNAPSHOT/src/clojure/mirabelle/action.clj#L1031">view source</a></div></div><div class="public anchor" id="var-ewma-timeless*"><h3>ewma-timeless*</h3><div class="usage"><code>(ewma-timeless* _ r &amp; children)</code></div><div class="doc"><div class="markdown"></div></div><div class="src-link"><a href="https://github.com/mcorbin/mirabelle/blob/0.1.0-SNAPSHOT/src/clojure/mirabelle/action.clj#L1016">view source</a></div></div><div class="public anchor" id="var-expired"><h3>expired</h3><div class="usage"><code>(expired &amp; children)</code></div><div class="doc"><div class="markdown"><p>Keep expired events</p>
<pre><code class="clojure">(expired
  (increment))
</code></pre></div></div><div class="src-link"><a href="https://github.com/mcorbin/mirabelle/blob/0.1.0-SNAPSHOT/src/clojure/mirabelle/action.clj#L328">view source</a></div></div><div class="public anchor" id="var-expired*"><h3>expired*</h3><div class="usage"><code>(expired* _ &amp; children)</code></div><div class="doc"><div class="markdown"><p>Keep expired events.</p></div></div><div class="src-link"><a href="https://github.com/mcorbin/mirabelle/blob/0.1.0-SNAPSHOT/src/clojure/mirabelle/action.clj#L318">view source</a></div></div><div class="public anchor" id="var-fixed-event-window"><h3>fixed-event-window</h3><div class="usage"><code>(fixed-event-window size &amp; children)</code></div><div class="doc"><div class="markdown"><p>Returns a fixed-sized window of events</p>
<pre><code class="clojure">(fixed-event-window 5
  (debug))
</code></pre>
<p>This example will return a vector events partitioned 5 by 5.</p></div></div><div class="src-link"><a href="https://github.com/mcorbin/mirabelle/blob/0.1.0-SNAPSHOT/src/clojure/mirabelle/action.clj#L212">view source</a></div></div><div class="public anchor" id="var-fixed-event-window*"><h3>fixed-event-window*</h3><div class="usage"><code>(fixed-event-window* _ size &amp; children)</code></div><div class="doc"><div class="markdown"></div></div><div class="src-link"><a href="https://github.com/mcorbin/mirabelle/blob/0.1.0-SNAPSHOT/src/clojure/mirabelle/action.clj#L198">view source</a></div></div><div class="public anchor" id="var-fixed-time-window"><h3>fixed-time-window</h3><div class="usage"><code>(fixed-time-window n &amp; children)</code></div><div class="doc"><div class="markdown"><p>A fixed window over the event stream in time. Emits vectors of events, such that each vector has events from a distinct n-second interval. Windows do <em>not</em> overlap; each event appears at most once in the output stream. Once an event is emitted, all events <em>older or equal</em> to that emitted event are silently dropped.</p>
<p>Events without times accrue in the current window.</p></div></div><div class="src-link"><a href="https://github.com/mcorbin/mirabelle/blob/0.1.0-SNAPSHOT/src/clojure/mirabelle/action.clj#L975">view source</a></div></div><div class="public anchor" id="var-fixed-time-window*"><h3>fixed-time-window*</h3><div class="usage"><code>(fixed-time-window* _ n &amp; children)</code></div><div class="doc"><div class="markdown"></div></div><div class="src-link"><a href="https://github.com/mcorbin/mirabelle/blob/0.1.0-SNAPSHOT/src/clojure/mirabelle/action.clj#L927">view source</a></div></div><div class="public anchor" id="var-increment"><h3>increment</h3><div class="usage"><code>(increment &amp; children)</code></div><div class="doc"><div class="markdown"><p>Decrement the event :metric field.</p></div></div><div class="src-link"><a href="https://github.com/mcorbin/mirabelle/blob/0.1.0-SNAPSHOT/src/clojure/mirabelle/action.clj#L128">view source</a></div></div><div class="public anchor" id="var-increment*"><h3>increment*</h3><div class="usage"><code>(increment* _ &amp; children)</code></div><div class="doc"><div class="markdown"></div></div><div class="src-link"><a href="https://github.com/mcorbin/mirabelle/blob/0.1.0-SNAPSHOT/src/clojure/mirabelle/action.clj#L122">view source</a></div></div><div class="public anchor" id="var-index.21"><h3>index!</h3><div class="usage"><code>(index! labels)</code></div><div class="doc"><div class="markdown"><p>Push events to an external system</p></div></div><div class="src-link"><a href="https://github.com/mcorbin/mirabelle/blob/0.1.0-SNAPSHOT/src/clojure/mirabelle/action.clj#L1193">view source</a></div></div><div class="public anchor" id="var-index.21*"><h3>index!*</h3><div class="usage"><code>(index!* context labels)</code></div><div class="doc"><div class="markdown"></div></div><div class="src-link"><a href="https://github.com/mcorbin/mirabelle/blob/0.1.0-SNAPSHOT/src/clojure/mirabelle/action.clj#L1180">view source</a></div></div><div class="public anchor" id="var-info"><h3>info</h3><div class="usage"><code>(info &amp; children)</code></div><div class="doc"><div class="markdown"><p>Print the event in the logs using the info level</p>
<pre><code class="clojure">(increment
  (debug))
</code></pre></div></div><div class="src-link"><a href="https://github.com/mcorbin/mirabelle/blob/0.1.0-SNAPSHOT/src/clojure/mirabelle/action.clj#L169">view source</a></div></div><div class="public anchor" id="var-info*"><h3>info*</h3><div class="usage"><code>(info* _ &amp; children)</code></div><div class="doc"><div class="markdown"></div></div><div class="src-link"><a href="https://github.com/mcorbin/mirabelle/blob/0.1.0-SNAPSHOT/src/clojure/mirabelle/action.clj#L163">view source</a></div></div><div class="public anchor" id="var-keep-non-discarded-events"><h3>keep-non-discarded-events</h3><div class="usage"><code>(keep-non-discarded-events events)</code></div><div class="doc"><div class="markdown"></div></div><div class="src-link"><a href="https://github.com/mcorbin/mirabelle/blob/0.1.0-SNAPSHOT/src/clojure/mirabelle/action.clj#L518">view source</a></div></div><div class="public anchor" id="var-moving-event-window"><h3>moving-event-window</h3><div class="usage"><code>(moving-event-window n &amp; children)</code></div><div class="doc"><div class="markdown"><p>A sliding window of the last few events. Every time an event arrives, calls children with a vector of the last n events, from oldest to newest. Ignores event times. Example:</p>
<pre><code class="clojure">(moving-event-window 5 (coll-mean (info))
</code></pre></div></div><div class="src-link"><a href="https://github.com/mcorbin/mirabelle/blob/0.1.0-SNAPSHOT/src/clojure/mirabelle/action.clj#L1001">view source</a></div></div><div class="public anchor" id="var-moving-event-window*"><h3>moving-event-window*</h3><div class="usage"><code>(moving-event-window* _ n &amp; children)</code></div><div class="doc"><div class="markdown"></div></div><div class="src-link"><a href="https://github.com/mcorbin/mirabelle/blob/0.1.0-SNAPSHOT/src/clojure/mirabelle/action.clj#L990">view source</a></div></div><div class="public anchor" id="var-not-expired"><h3>not-expired</h3><div class="usage"><code>(not-expired &amp; children)</code></div><div class="doc"><div class="markdown"><p>Keep non-expired events</p>
<pre><code class="clojure">(not-expired
  (increment))
</code></pre></div></div><div class="src-link"><a href="https://github.com/mcorbin/mirabelle/blob/0.1.0-SNAPSHOT/src/clojure/mirabelle/action.clj#L349">view source</a></div></div><div class="public anchor" id="var-not-expired*"><h3>not-expired*</h3><div class="usage"><code>(not-expired* _ &amp; children)</code></div><div class="doc"><div class="markdown"><p>Keep non-expired events.</p></div></div><div class="src-link"><a href="https://github.com/mcorbin/mirabelle/blob/0.1.0-SNAPSHOT/src/clojure/mirabelle/action.clj#L339">view source</a></div></div><div class="public anchor" id="var-outside-dt"><h3>outside-dt</h3><div class="usage"><code>(outside-dt low high dt &amp; children)</code></div><div class="doc"><div class="markdown"><p>Takes two numbers, <code>low</code> and <code>high</code>, and a time period in seconds, <code>dt</code>. If the condition <code>the event metric is &lt; low or &gt; high</code> is valid for all events received during at least the period <code>dt</code>, valid events received after the <code>dt</code> period will be passed on until an invalid event arrives. <code>:metric</code> should not be nil (it will produce exceptions).</p></div></div><div class="src-link"><a href="https://github.com/mcorbin/mirabelle/blob/0.1.0-SNAPSHOT/src/clojure/mirabelle/action.clj#L446">view source</a></div></div><div class="public anchor" id="var-over"><h3>over</h3><div class="usage"><code>(over n &amp; children)</code></div><div class="doc"><div class="markdown"><p>Passes on events only when their metric is greater than x</p></div></div><div class="src-link"><a href="https://github.com/mcorbin/mirabelle/blob/0.1.0-SNAPSHOT/src/clojure/mirabelle/action.clj#L1055">view source</a></div></div><div class="public anchor" id="var-over*"><h3>over*</h3><div class="usage"><code>(over* _ n &amp; children)</code></div><div class="doc"><div class="markdown"></div></div><div class="src-link"><a href="https://github.com/mcorbin/mirabelle/blob/0.1.0-SNAPSHOT/src/clojure/mirabelle/action.clj#L1045">view source</a></div></div><div class="public anchor" id="var-percentiles"><h3>percentiles</h3><div class="usage"><code>(percentiles points &amp; children)</code></div><div class="doc"><div class="markdown"><p>Over each period of interval seconds, aggregates events and selects one event from that period for each point. If point is 0, takes the lowest metric event. If point is 1, takes the highest metric event. 0.5 is the median event, and so forth. Forwards each of these events to children. The event has the point appended the <code>:quantile</code> key. Useful for extracting histograms and percentiles.</p>
<pre><code class="clojure">(fixed-event-window 10
  (percentiles [0.5 .0.75 0.98 0.99]))
</code></pre></div></div><div class="src-link"><a href="https://github.com/mcorbin/mirabelle/blob/0.1.0-SNAPSHOT/src/clojure/mirabelle/action.clj#L1250">view source</a></div></div><div class="public anchor" id="var-percentiles*"><h3>percentiles*</h3><div class="usage"><code>(percentiles* _ points &amp; children)</code></div><div class="doc"><div class="markdown"></div></div><div class="src-link"><a href="https://github.com/mcorbin/mirabelle/blob/0.1.0-SNAPSHOT/src/clojure/mirabelle/action.clj#L1240">view source</a></div></div><div class="public anchor" id="var-project*"><h3>project*</h3><div class="usage"><code>(project* _ conditions &amp; children)</code></div><div class="doc"><div class="markdown"></div></div><div class="src-link"><a href="https://github.com/mcorbin/mirabelle/blob/0.1.0-SNAPSHOT/src/clojure/mirabelle/action.clj#L1117">view source</a></div></div><div class="public anchor" id="var-push-io.21"><h3>push-io!</h3><div class="usage"><code>(push-io! io-name)</code></div><div class="doc"><div class="markdown"><p>Push events to an external system</p></div></div><div class="src-link"><a href="https://github.com/mcorbin/mirabelle/blob/0.1.0-SNAPSHOT/src/clojure/mirabelle/action.clj#L534">view source</a></div></div><div class="public anchor" id="var-push-io.21*"><h3>push-io!*</h3><div class="usage"><code>(push-io!* context io-name)</code></div><div class="doc"><div class="markdown"></div></div><div class="src-link"><a href="https://github.com/mcorbin/mirabelle/blob/0.1.0-SNAPSHOT/src/clojure/mirabelle/action.clj#L523">view source</a></div></div><div class="public anchor" id="var-reinject.21"><h3>reinject!</h3><div class="usage"><code>(reinject!)</code><code>(reinject! destination-stream)</code></div><div class="doc"><div class="markdown"><p>Reinject an event into the streaming system.</p></div></div><div class="src-link"><a href="https://github.com/mcorbin/mirabelle/blob/0.1.0-SNAPSHOT/src/clojure/mirabelle/action.clj#L1323">view source</a></div></div><div class="public anchor" id="var-reinject.21*"><h3>reinject!*</h3><div class="usage"><code>(reinject!* context destination-stream)</code></div><div class="doc"><div class="markdown"></div></div><div class="src-link"><a href="https://github.com/mcorbin/mirabelle/blob/0.1.0-SNAPSHOT/src/clojure/mirabelle/action.clj#L1317">view source</a></div></div><div class="public anchor" id="var-scale"><h3>scale</h3><div class="usage"><code>(scale factor &amp; children)</code></div><div class="doc"><div class="markdown"><p>Multiplies the event :metric field by :factor</p></div></div><div class="src-link"><a href="https://github.com/mcorbin/mirabelle/blob/0.1.0-SNAPSHOT/src/clojure/mirabelle/action.clj#L830">view source</a></div></div><div class="public anchor" id="var-scale*"><h3>scale*</h3><div class="usage"><code>(scale* _ factor &amp; children)</code></div><div class="doc"><div class="markdown"></div></div><div class="src-link"><a href="https://github.com/mcorbin/mirabelle/blob/0.1.0-SNAPSHOT/src/clojure/mirabelle/action.clj#L823">view source</a></div></div><div class="public anchor" id="var-sdissoc"><h3>sdissoc</h3><div class="usage"><code>(sdissoc fields &amp; children)</code></div><div class="doc"><div class="markdown"><p>Remove a key (or a list of keys) from the event</p>
<p>```clojure (sdissoc :host (info))</p>
<p>(sdissoc <a href="info">:environment :host</a>)</p></div></div><div class="src-link"><a href="https://github.com/mcorbin/mirabelle/blob/0.1.0-SNAPSHOT/src/clojure/mirabelle/action.clj#L1226">view source</a></div></div><div class="public anchor" id="var-sdissoc*"><h3>sdissoc*</h3><div class="usage"><code>(sdissoc* _ fields &amp; children)</code></div><div class="doc"><div class="markdown"></div></div><div class="src-link"><a href="https://github.com/mcorbin/mirabelle/blob/0.1.0-SNAPSHOT/src/clojure/mirabelle/action.clj#L1220">view source</a></div></div><div class="public anchor" id="var-sdo"><h3>sdo</h3><div class="usage"><code>(sdo &amp; children)</code></div><div class="doc"><div class="markdown"><p>Send events to children</p>
<pre><code class="clojure">(sdo
  (increment)
  (decrement))
</code></pre></div></div><div class="src-link"><a href="https://github.com/mcorbin/mirabelle/blob/0.1.0-SNAPSHOT/src/clojure/mirabelle/action.clj#L306">view source</a></div></div><div class="public anchor" id="var-sdo*"><h3>sdo*</h3><div class="usage"><code>(sdo* _ &amp; children)</code></div><div class="doc"><div class="markdown"></div></div><div class="src-link"><a href="https://github.com/mcorbin/mirabelle/blob/0.1.0-SNAPSHOT/src/clojure/mirabelle/action.clj#L301">view source</a></div></div><div class="public anchor" id="var-sflatten"><h3>sflatten</h3><div class="usage"><code>(sflatten &amp; children)</code></div><div class="doc"><div class="markdown"><p>Streaming flatten. Calls children with each event in events. Events should be a sequence.</p>
<p>This stream can be used to flat a sequence of events (emitted by a time window stream for example).</p></div></div><div class="src-link"><a href="https://github.com/mcorbin/mirabelle/blob/0.1.0-SNAPSHOT/src/clojure/mirabelle/action.clj#L703">view source</a></div></div><div class="public anchor" id="var-sflatten*"><h3>sflatten*</h3><div class="usage"><code>(sflatten* _ &amp; children)</code></div><div class="doc"><div class="markdown"></div></div><div class="src-link"><a href="https://github.com/mcorbin/mirabelle/blob/0.1.0-SNAPSHOT/src/clojure/mirabelle/action.clj#L697">view source</a></div></div><div class="public anchor" id="var-split"><h3>split</h3><div class="usage"><code>(split &amp; clauses)</code></div><div class="doc"><div class="markdown"><p>Split by conditions.</p>
<pre><code>(split
  [:&gt; :metric 10] (debug)
  [:&gt; :metric 5] (info)
  (critical)
</code></pre>
<p>In this example, all events with :metric &gt; 10 will go into the debug stream, all events with :metric &gt; 5 in the info stream, and other events will to the default stream which is critical.</p>
<p>The default stream is optional, if not set all events not matching a condition will be discarded.</p></div></div><div class="src-link"><a href="https://github.com/mcorbin/mirabelle/blob/0.1.0-SNAPSHOT/src/clojure/mirabelle/action.clj#L855">view source</a></div></div><div class="public anchor" id="var-split*"><h3>split*</h3><div class="usage"><code>(split* _ clauses &amp; children)</code></div><div class="doc"><div class="markdown"></div></div><div class="src-link"><a href="https://github.com/mcorbin/mirabelle/blob/0.1.0-SNAPSHOT/src/clojure/mirabelle/action.clj#L838">view source</a></div></div><div class="public anchor" id="var-tag"><h3>tag</h3><div class="usage"><code>(tag tags &amp; children)</code></div><div class="doc"><div class="markdown"><p>Adds a new tag, or set of tags, to events which flow through.</p>
<p>(tag foo (info)) (tag <a href="info">foo bar</a>)</p></div></div><div class="src-link"><a href="https://github.com/mcorbin/mirabelle/blob/0.1.0-SNAPSHOT/src/clojure/mirabelle/action.clj#L725">view source</a></div></div><div class="public anchor" id="var-tag*"><h3>tag*</h3><div class="usage"><code>(tag* _ tags &amp; children)</code></div><div class="doc"><div class="markdown"></div></div><div class="src-link"><a href="https://github.com/mcorbin/mirabelle/blob/0.1.0-SNAPSHOT/src/clojure/mirabelle/action.clj#L714">view source</a></div></div><div class="public anchor" id="var-tagged-all"><h3>tagged-all</h3><div class="usage"><code>(tagged-all tags &amp; children)</code></div><div class="doc"><div class="markdown"><p>Passes on events where all tags are present. This stream returns true if an event it receives matches those tags, nil otherwise.</p>
<p>Can be used as a predicate in a where form.</p>
<pre><code class="clojure">(tagged-all "foo" (info))
(tagged-all ["foo" "bar"] (info))
</code></pre></div></div><div class="src-link"><a href="https://github.com/mcorbin/mirabelle/blob/0.1.0-SNAPSHOT/src/clojure/mirabelle/action.clj#L772">view source</a></div></div><div class="public anchor" id="var-tagged-all*"><h3>tagged-all*</h3><div class="usage"><code>(tagged-all* _ tags &amp; children)</code></div><div class="doc"><div class="markdown"></div></div><div class="src-link"><a href="https://github.com/mcorbin/mirabelle/blob/0.1.0-SNAPSHOT/src/clojure/mirabelle/action.clj#L760">view source</a></div></div><div class="public anchor" id="var-test-action"><h3>test-action</h3><div class="usage"><code>(test-action state &amp; children)</code></div><div class="doc"><div class="markdown"><p>Bufferize all received events in the state (an atom) passed as parameter</p></div></div><div class="src-link"><a href="https://github.com/mcorbin/mirabelle/blob/0.1.0-SNAPSHOT/src/clojure/mirabelle/action.clj#L293">view source</a></div></div><div class="public anchor" id="var-test-action*"><h3>test-action*</h3><div class="usage"><code>(test-action* _ state)</code></div><div class="doc"><div class="markdown"></div></div><div class="src-link"><a href="https://github.com/mcorbin/mirabelle/blob/0.1.0-SNAPSHOT/src/clojure/mirabelle/action.clj#L288">view source</a></div></div><div class="public anchor" id="var-throttle"><h3>throttle</h3><div class="usage"><code>(throttle dt &amp; children)</code></div><div class="doc"><div class="markdown"><p>Let one event pass at most every dt seconds. Can be used for example to avoid sending to limit the number of alerts sent to an external system.</p>
<pre><code class="clojure">(throttle 10
  (alert))
</code></pre>
<p>In this example, throttle will let one event pass at most every 10 seconds. Other events, or events with no time, are filtered.</p></div></div><div class="src-link"><a href="https://github.com/mcorbin/mirabelle/blob/0.1.0-SNAPSHOT/src/clojure/mirabelle/action.clj#L908">view source</a></div></div><div class="public anchor" id="var-throttle*"><h3>throttle*</h3><div class="usage"><code>(throttle* _ dt &amp; children)</code></div><div class="doc"><div class="markdown"></div></div><div class="src-link"><a href="https://github.com/mcorbin/mirabelle/blob/0.1.0-SNAPSHOT/src/clojure/mirabelle/action.clj#L890">view source</a></div></div><div class="public anchor" id="var-under"><h3>under</h3><div class="usage"><code>(under n &amp; children)</code></div><div class="doc"><div class="markdown"><p>Passes on events only when their metric is greater than x</p></div></div><div class="src-link"><a href="https://github.com/mcorbin/mirabelle/blob/0.1.0-SNAPSHOT/src/clojure/mirabelle/action.clj#L1074">view source</a></div></div><div class="public anchor" id="var-under*"><h3>under*</h3><div class="usage"><code>(under* _ n &amp; children)</code></div><div class="doc"><div class="markdown"></div></div><div class="src-link"><a href="https://github.com/mcorbin/mirabelle/blob/0.1.0-SNAPSHOT/src/clojure/mirabelle/action.clj#L1064">view source</a></div></div><div class="public anchor" id="var-untag"><h3>untag</h3><div class="usage"><code>(untag tags &amp; children)</code></div><div class="doc"><div class="markdown"><p>Removes a tag, or set of tags, from events which flow through.</p>
<p>(untag foo index) (untag [foo bar] index)</p></div></div><div class="src-link"><a href="https://github.com/mcorbin/mirabelle/blob/0.1.0-SNAPSHOT/src/clojure/mirabelle/action.clj#L748">view source</a></div></div><div class="public anchor" id="var-untag*"><h3>untag*</h3><div class="usage"><code>(untag* _ tags &amp; children)</code></div><div class="doc"><div class="markdown"></div></div><div class="src-link"><a href="https://github.com/mcorbin/mirabelle/blob/0.1.0-SNAPSHOT/src/clojure/mirabelle/action.clj#L736">view source</a></div></div><div class="public anchor" id="var-valid-condition.3F"><h3>valid-condition?</h3><div class="usage"><code>(valid-condition? condition)</code></div><div class="doc"><div class="markdown"></div></div><div class="src-link"><a href="https://github.com/mcorbin/mirabelle/blob/0.1.0-SNAPSHOT/src/clojure/mirabelle/action.clj#L37">view source</a></div></div><div class="public anchor" id="var-warning"><h3>warning</h3><div class="usage"><code>(warning &amp; children)</code></div><div class="doc"><div class="markdown"><p>Keep all events in state warning</p></div></div><div class="src-link"><a href="https://github.com/mcorbin/mirabelle/blob/0.1.0-SNAPSHOT/src/clojure/mirabelle/action.clj#L493">view source</a></div></div><div class="public anchor" id="var-warning*"><h3>warning*</h3><div class="usage"><code>(warning* _ &amp; children)</code></div><div class="doc"><div class="markdown"></div></div><div class="src-link"><a href="https://github.com/mcorbin/mirabelle/blob/0.1.0-SNAPSHOT/src/clojure/mirabelle/action.clj#L487">view source</a></div></div><div class="public anchor" id="var-where"><h3>where</h3><div class="usage"><code>(where conditions &amp; children)</code></div><div class="doc"><div class="markdown"><p>Filter events based on conditions. Each condition is a vector composed of the function to apply on the field, the field to extract from the event, and the event itself. Multiple conditions can be added by using <code>:or</code> or <code>:and</code>.</p>
<pre><code class="clojure">(where [:= :metric 4])
</code></pre>
<p>Here, we keep only events where the :metric field is equal to 4.</p>
<pre><code class="clojure">(where [:and [:= :host "foo"]
             [:&gt; :metric 10])
</code></pre>
<p>Here, we keep only events with :host = foo and with :metric &gt; 10</p></div></div><div class="src-link"><a href="https://github.com/mcorbin/mirabelle/blob/0.1.0-SNAPSHOT/src/clojure/mirabelle/action.clj#L98">view source</a></div></div><div class="public anchor" id="var-where*"><h3>where*</h3><div class="usage"><code>(where* _ conditions &amp; children)</code></div><div class="doc"><div class="markdown"></div></div><div class="src-link"><a href="https://github.com/mcorbin/mirabelle/blob/0.1.0-SNAPSHOT/src/clojure/mirabelle/action.clj#L88">view source</a></div></div><div class="public anchor" id="var-with"><h3>with</h3><div class="usage"><code>(with &amp; args)</code></div><div class="doc"><div class="markdown"><p>Set an event field to the given value.</p>
<pre><code class="clojure">(with :state "critical"
  (debug))
</code></pre>
<p>A map can also be provided:</p>
<p><code>
</code>clojure (with {:host nil :state critical}  (debug)) ```</p>
<p>This example set the field :state to critical for events.</p></div></div><div class="src-link"><a href="https://github.com/mcorbin/mirabelle/blob/0.1.0-SNAPSHOT/src/clojure/mirabelle/action.clj#L635">view source</a></div></div><div class="public anchor" id="var-with*"><h3>with*</h3><div class="usage"><code>(with* _ fields &amp; children)</code></div><div class="doc"><div class="markdown"></div></div><div class="src-link"><a href="https://github.com/mcorbin/mirabelle/blob/0.1.0-SNAPSHOT/src/clojure/mirabelle/action.clj#L630">view source</a></div></div><div class="public anchor" id="var-write.21"><h3>write!</h3><div class="usage"><code>(write!)</code></div><div class="doc"><div class="markdown"><p>Write events into the on-disk queue.</p></div></div><div class="src-link"><a href="https://github.com/mcorbin/mirabelle/blob/0.1.0-SNAPSHOT/src/clojure/mirabelle/action.clj#L1311">view source</a></div></div><div class="public anchor" id="var-write.21*"><h3>write!*</h3><div class="usage"><code>(write!* context)</code></div><div class="doc"><div class="markdown"></div></div><div class="src-link"><a href="https://github.com/mcorbin/mirabelle/blob/0.1.0-SNAPSHOT/src/clojure/mirabelle/action.clj#L1303">view source</a></div></div></div></body></html>